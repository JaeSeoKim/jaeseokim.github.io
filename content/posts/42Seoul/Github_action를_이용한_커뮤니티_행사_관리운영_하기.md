---
title: "Github actionë¥¼ ì´ìš©í•œ ì»¤ë®¤ë‹ˆí‹° í–‰ì‚¬ ê´€ë¦¬/ìš´ì˜ í•˜ê¸°!"
date: 2021-08-20
tags: ["github-action", "42js", "jspiscine"]
draft: false
---

![og_image](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/OG_IMAGE.png)

**42Seoul**ì˜ ê³µì‹ ì»¤ë®¤ë‹ˆí‹°ì¸ **42JS**ì— ê¸°íší•˜ê³  ì œìž‘ì„ í•œ `Javascript ë‹¨ê¸° êµìœ¡ê³¼ì •` ì¼ëª… `í”¼ì”¬(Piscine)` ë¥¼ ì‹¤ì œ **42Seoul** í•™ìƒë“¤ì„ ëŒ€ìƒìœ¼ë¡œ ë² íƒ€ë¡œ ì§„í–‰ì„ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤!

> â„¹ï¸ JS Piscineì— ë” ì•Œê³  ì‹¶ì€ ë¶„ë“¤ì€ ì•„ëž˜ì˜ repoë¡œ ë“¤ì–´ê°€ ì£¼ì„¸ìš”!
>
> https://github.com/42js/piscine

ì›ëž˜ ìµœì´ˆì˜ ê³„íšì€ í•™ìƒë“¤ì´ ë§Œë“  êµìœ¡ ê³¼ì •ì˜ ë¬¸ì œ `subject` ë“¤ì„ ê¸°ì¡´ `42Intra` ì‹œìŠ¤í…œì— ì¶”ê°€ë¥¼ í•˜ì—¬ì„œ ì§„í–‰ì„ í•˜ëŠ” ê²ƒ ì´ì˜€ì§€ë§Œ ì‹œìŠ¤í…œì— ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œëŠ” subject ì— ëŒ€í•œ ê²€ì¦ ë° ë¶€ê°€ ì ìœ¼ë¡œ ì—®ì´ëŠ” ì‹œìŠ¤í…œì— ê´€ë ¨ëœ ì´ìŠˆë“¤ì´ ìžˆê¸° ë•Œë¬¸ì— ì´ë²ˆ ë² íƒ€ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ìžì²´ì ìœ¼ë¡œ ì§„í–‰í•˜ê¸°ë¡œ ê²°ì •ì„ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

ì›í• í•œ ì§„í–‰ì„ ìœ„í•´ `google sheet` ì™€ `form` ë¥¼ ì´ìš©í•˜ì—¬ ì ìˆ˜ ë° í†µê³„ë¥¼ ë‚˜íƒ€ë‚´ë„ë¡ ì œìž‘ì„ í•˜ì˜€ê³  ì´ì œ subjectì— ëŒ€í•œ í‰ê°€ë¥¼ ì œì¶œ í•˜ê³  ì´ì— ëŒ€í•œ ë¦¬ë·°ì–´(í‰ê°€ìž)ë¥¼ ë§¤ì¹­ ì‹œí‚¤ëŠ” ê²ƒì— ëŒ€í•´ì„œ ê³ ë¯¼ì„ ë§Žì´ í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ìµœì´ˆì— ì ìš©í•œ ë°©ë²•ì€ ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤.

1. í”¼í‰ê°€ìžê°€ ë¬¸ì œë¥¼ í’€ê³  í•´ë‹¹ Subjectì˜ ì •ë‹µì˜ ì½”ë“œë¥¼ `PR` í˜•íƒœë¡œ ì œì¶œ
2. 42JS ìŠ¤íƒœí”„ê°€ `PR` ì œì¶œ ì‹œê°„, ì¶”ê°€ ê·œì¹™ ë“±ì„ í™•ì¸ í›„ `Github Team Code review assignment` ë¥¼ í™œìš©í•˜ì—¬ ë¦¬ë·°ì–´ë¥¼ ë°°ì •
3. ë¦¬ë·°ì–´ê°€ ë°°ì •ì´ ë˜ë©´ í‰ê°€ ê¸°ê°„ë‚´ì— `google form` ë¥¼ ì´ìš©í•˜ì—¬ í‰ê°€ ì§„í–‰ í›„ í•´ë‹¹ ì •ë³´ì™€ í•¨ê»˜ `PR review` ë¥¼ í†µí•´ ê¸°ë¡

ì›ëž˜ íšŒì˜ë¥¼ ì§„í–‰ í•˜ë©´ì„œ ë¦¬ë·°ì–´ë¥¼ ë§¤ì¹­ í•˜ëŠ” ê²ƒì— ëŒ€í•´ `code owner` ê¸°ëŠ¥ `github action` ë“± ë§Žì€ ì´ì•¼ê¸°ê°€ ì˜¤ê°”ì§€ë§Œ ì²«ë²ˆì§¸ì¸ `code owner` ëŠ” team ê¶Œí•œì„ `write`ê¹Œì§€ ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì— **ë³´ì•ˆ ì´ìŠˆ**ì™€ **ì¤‘ë„ í¬ê¸°ìž**ì— ëŒ€í•œ ì²˜ë¦¬ì™€ í•¨ê»˜ ë¶€ê°€ì ìœ¼ë¡œ ì˜¤ëŠ” ì´ìŠˆë“¤ì„ í•´ê²° í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì— ë¬´ì‚°ì´ ë˜ì—ˆê³  ë‘ë²ˆì§¸ì¸ `github action` ì€ ì‹œìž‘ì¼ì´ ì–¼ë§ˆ ë‚¨ì§€ ì•Šì•„ì„œ í˜„ìž¬ ìƒí™©ì—ì„œëŠ” ì ìš©ì´ ì–´ë ¤ìš°ë‹ˆ ì¤‘ê°„ì— ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤ë©´ ì ìš©í•˜ê¸°ë¡œ í•˜ê³  ì¼ë‹¨ ìˆ˜ë™ìœ¼ë¡œ ì§„í–‰í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

í˜„ìž¬ **8ì›” 16ì¼** ì²« ë‚ ì— í•´ë‹¹ ë‹´ë‹¹í•˜ê¸°ë¡œí•œ `sunpark` ë‹˜ê»˜ì„œ ì§ì ‘ ì§„í–‰ì„ í•˜ì˜€ëŠ”ë° ì‹¤ì œ ìˆ˜ ìž‘ì—…ìœ¼ë¡œ ì§„í–‰í•´ë³´ë‹ˆ **ì•½ 10ë¶„ê°„** ì˜ ì‹œê°„ì´ ì†Œìš”ëœë‹¤ê³  í•˜ì˜€ê³  ë‹¤ìŒë‚ ë¶€í„°ëŠ” í‰ê°€ í™•ì¸ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìž‘ì—…ì„ ì§„í–‰ í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë” ë§Žì€ ì‹œê°„ ì†Œìš”ê°€ ë§Žì´ ë˜ê¸° ë•Œë¬¸ì— `github action` ë¥¼ ì´ìš©í•˜ì—¬ ìžë™í™”ë¥¼ ì„¤ì • í•˜ê¸°ë¡œ ê²°ì‹¬ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

![image-20210820151530372](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/image-20210820151530372.png)

## Github Action í™œìš© ë²”ìœ„ ì„ ì • í•˜ê¸°!

ì¼ë‹¨ ìžë™í™”ë¥¼ êµ¬ì¶• í•˜ê¸° ìœ„í•´ ì¼ë‹¨ ìžë™í™”ë¥¼ ì–´ë–¤ í˜•íƒœë¡œ ì§„í–‰ í•  ê²ƒì¸ì§€ì— ëŒ€í•´ì„œ ì •ì˜ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤.

`Github Action` ì—ì„œ ì œê³µ í•˜ëŠ” íŠ¸ë¦¬ê±° ì´ë²¤íŠ¸ `pull_request opened` ë¥¼ í™œìš©í•˜ì—¬ ìžë™ìœ¼ë¡œ PRì˜ ì œì¶œ ì‹œê°„ì— ëŒ€í•´ì„œ ê²€ì¦ í•˜ê³  ë¼ë²¨ì„ ë¶™ì—¬ ì£¼ëŠ” ìž‘ì—…, ì´í›„ `Github Action Input` ë¥¼ ì´ìš©í•˜ì—¬ ì „ ë‹¨ê³„ì—ì„œ ì •ìƒì ì¸ ë¼ë²¨ì¼ ë•Œ ë¦¬ë·°ì–´ë¥¼ ë°°ì • í•˜ëŠ” ê²ƒì„ ìµœì†Œ `MVP` ë¡œ ì •ì˜ë¥¼ í•˜ê³  êµ¬í˜„í•˜ê¸° ìœ„í•´ ì–´ë–¤ ìž‘ì—…ì´ í•„ìš” í•œì§€ ìƒê°ì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.

Ãì¼ë‹¨ **PR ê²€ì¦ ê¸°ëŠ¥** êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ì¼ë‹¨ ì œì¶œ ê²½ë¡œì— ë”°ë¥¸ ë§ˆê° ì‹œê°„ì´ ì„œë¡œ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— **ì œì¶œ í•œ íŒŒì¼ì— ëŒ€í•´ ì–´ë–¤ ê²½ë¡œì— ì†í•´ ìžˆëŠ”ì§€**ì— ëŒ€í•´ ì²´í¬ë¥¼ í•˜ëŠ” ë¶€ë¶„ê³¼ **ì œì¶œ ê²½ë¡œì™€ ë§ˆê° ì‹œê°„ë“±**ì„ **ì„¤ì • íŒŒì¼**ì˜ ì •ë³´ë¥¼ ê°€ì ¸ ì˜¬ ìˆ˜ ìžˆëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„ì„ í•´ì•¼ í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤ê³  ìƒê°ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ì œ í•´ë‹¹ ìžë™í™”ë¥¼ êµ¬ì¶• í•˜ê¸°ì— ì•žì„œ ê¸°ì¡´ì— ë§Œë“¤ì–´ì§„ Appì„ ì´ìš©í•˜ë ¤ê³  í•˜ì˜€ì§€ë§Œ ì œì¶œ ê²½ë¡œì— ë”°ë¥¸ ì œì¶œ ì‹œê°„ë“±ì´ ì¡°ê±´ìœ¼ë¡œ ê±¸ë ¤ìžˆëŠ” ë¶€ë¶„ì„ ì„¸ë°€ í•˜ê²Œ ì •ì˜ í•˜ëŠ” ê²ƒì´ ê¸°ì¡´ APPì—ì„œëŠ” ë¶ˆê°€ëŠ¥ í•˜ê¸° ë•Œë¬¸ì— **ì§ì ‘ Script** ë¥¼ ìž‘ì„±í•˜ì—¬ êµ¬í˜„ í•˜ëŠ” ê²ƒìœ¼ë¡œ ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

ì¼ë‹¨ GitHub actionì—ì„œ Appë¥¼ ê°œë°œ í•˜ëŠ” ë°©ë²•ì—ëŠ” **Docker Image**, **Javascript** ë“± ë‹¤ì–‘í•œ ë°©ë²•ì´ ìžˆì§€ë§Œ **javascript ì»¤ë®¤ë‹ˆí‹°** ì´ê¸°ë„ í•˜ê³  ë˜í•œ ì €ì˜ ì£¼ë ¥ì–¸ì–´ê°€ typescript ì´ê¸° ë•Œë¬¸ì— **typescriptë¡œ ê°œë°œ**ì„ í•˜ê¸°ë¡œ ì •í•˜ì˜€ìŠµë‹ˆë‹¤!

ì´ì œ êµ¬í˜„ì„ í•˜ê¸° ìœ„í•´ **Github**ì—ì„œ **[TypeScript-Action](https://github.com/actions/typescript-action)** í…œí”Œë¦¿ì„ ì œê³µì„ í•˜ì—¬ì„œ í•´ë‹¹ í…œí”Œë¦¿ì„ ì°¸ì¡° í•˜ì—¬ ê°œë°œì„ ì§„í–‰ í•˜ì—¿ìŠµë‹ˆë‹¤.

í…œí”Œë¦¿ì„ ì‚´íŽ´ ë³´ë©´ **[action-toolkit](https://github.com/actions/toolkit/blob/master/README.md#packages) **ë¥¼ ì‚¬ìš©í•˜ì—¬ actionë‚´ë¶€ì˜ ì—¬ëŸ¬ê°€ì§€ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ì •ë³´ë¥¼ ì™¸ë¶€ë¡œ ë³´ë‚´ëŠ” ê¸°ëŠ¥ github ì œì–´ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µ í•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ë©´ì„œ ê°œë°œì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

ë˜í•œ ìµœì¢…ì ìœ¼ë¡œ workflowê°€ ë™ìž‘ì„ í•  ë•Œ `node.js` ê°œë°œì´ ëœ ê²ƒì€ ë™ìž‘ì„ í• ë•Œ `node_modules` ë¼ëŠ” ë¬´ê±°ìš´ ì˜ì¡´ íŒŒì¼ì„ ê°€ì§€ê³  ìžˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— workflow ë‚´ë¶€ì— `npm install` ê³¼ ê°™ì€ ìž‘ì—…ì´ í¬í•¨ë˜ì–´ì•¼ í•˜ì§€ë§Œ `@vercel/ncc` ë¼ëŠ” CLI ë„êµ¬ë¥¼ ì´ìš©í•˜ì—¬ ì˜ì¡´ì„±ì„ ëª¨ë‘ ê°€ì§€ê³  ìžˆëŠ” `ë‹¨ì¼ JS` íŒŒì¼ë¡œ ë‚˜ì˜¬ ìˆ˜ ìžˆë„ë¡ ìž‘ì—…ì„ ì§„í–‰ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ì œ ê°œë°œì„ ì§„í–‰ í•˜ë©´ì„œ ì–´ë–¤ í˜•íƒœë¡œ `Debug` ë° `Test` ë¥¼ ì§„í–‰ í•˜ëŠ” ê²ƒì´ ê´€ê¶Œ ì´ì˜€ëŠ”ë° ë§¤ë²ˆ ì‹¤ì œ `Action` ë¥¼ ë™ìž‘ ì‹œí‚¤ëŠ” ê²ƒì€ íž˜ë“¤ê³  localì—ì„œ ë™ìž‘ í•˜ê²Œ í•´ì£¼ëŠ” [act](https://github.com/nektos/act) ë¼ëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ê¸° ì—ë„ PR ì´ë²¤íŠ¸ ë¼ëŠ” ì œì•½ ë•Œë¬¸ì— ì‚¬ìš©í•˜ê¸°ê°€ ì• ë§¤í•˜ë‹¤ê³  íŒë‹¨í•˜ê³  `Jest` ë¥¼ ì´ìš©í•œ `TDD` ë°©ë²•ë¡ ìœ¼ë¡œ ê°œë°œì„ ì§„í–‰ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤!

## Jestë¥¼ ì´ìš©í•˜ì—¬ GitHub action ê°œë°œí•˜ê¸°!

Jestë¥¼ ì´ìš©í•˜ì—¬ actionì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ë§¤ìš° ë‹¨ìˆœí•˜ê²Œ ìž‘ì„±ì„ í•˜ì˜€ëŠ” ë° íŠ¹ì • í•¨ìˆ˜ë¥¼ `mock` í•¨ìˆ˜ë¡œ ì„¤ì •ì„ í•˜ê³  ë™ìž‘ì„ í•  ë•Œ ì´ ëª‡ë²ˆ í˜¸ì¶œì„ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•´ì„œ í™•ì¸ì„ í•˜ë„ë¡ í•˜ëŠ” í˜•íƒœë¡œ ê°œë°œì„ ì§„í–‰ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ì„œ `action` ì´ ë™ìž‘ë˜ëŠ” í•¨ìˆ˜ì—ì„œëŠ” `core.error()` ë¥¼ 0ë²ˆ í˜¸ì¶œ í•´ì•¼ í•œë‹¤. ì´ëŸ° í˜•íƒœë¡œ ì •ìƒì ì¼ ë•Œì˜ ë™ìž‘ì„ ì •ì˜í›„ ë™ìž‘ ì‹œ ì§€ì •í•œ íšŸìˆ˜ì— ë§Œì¡± í•˜ì§€ ì•ŠëŠ” ë‹¤ë©´ í•´ë‹¹ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œì¡± í•  ìˆ˜ ìžˆëŠ” ì½”ë“œë¡œ ë‹¤ì‹œ ìž‘ì„± í•˜ëŠ” í˜•íƒœë¡œ ê°œë°œì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

ë˜í•œ ì‹¤ì œ ë™ìž‘ì‹œì—ë§Œ ê°ì²´ ë“¤ì— ëŒ€í•´ì„œë„ `Mock` í™”ë¥¼ ì‹œì¼œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰ í•˜ì—¬ ì ì§„ì ìœ¼ë¡œ ê°œë°œì„ ì§„í–‰ í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ ìž‘ì„±ëœ `run()` í•¨ìˆ˜ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ì•„ëž˜ì™€ ê°™ì´ ë§¤ìš° ê°„ë‹¨í•œ í˜•íƒœë¡œ ìž‘ì„±ì´ ì™„ë£Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

```typescript
it("run()ì‹œ ì •ìƒì ì´ë¼ë©´ ì •í•´ì§„ í•¨ìˆ˜ë“¤ì˜ íšŸìˆ˜ê°€ ë™ì¼í•˜ê²Œ ë™ìž‘", async () => {
  const errorMock = jest.spyOn(core, "error")
  const setFailedMock = jest.spyOn(core, "setFailed")

  const getOctokitMock = jest.spyOn(github, "getOctokit")

  const paginateMock = jest.spyOn(gh, "paginate")
  paginateMock.mockResolvedValue([
    {
      id: 42,
      filename: "js00/test.js",
    },
  ])

  const getPullsMock = jest.spyOn(gh.rest.pulls, "get")
  const addLabelsMock = jest.spyOn(gh.rest.issues, "addLabels")
  const removeLabelMock = jest.spyOn(gh.rest.issues, "removeLabel")
  const addCommentMock = jest.spyOn(gh.rest.issues, "createComment")

  await run()

  expect(getOctokitMock).toBeCalledTimes(1)

  expect(getPullsMock).toBeCalledTimes(1)
  expect(addLabelsMock).toBeCalledTimes(1)
  expect(removeLabelMock).toBeCalledTimes(0)
  expect(addCommentMock).toBeCalledTimes(1)

  expect(errorMock).toBeCalledTimes(0)
  expect(setFailedMock).toBeCalledTimes(0)
})
```

ë˜í•œ ë‚´ë¶€ì— ì‚¬ìš© ë˜ëŠ” ì—¬ëŸ¬ê°€ì§€ í•¨ìˆ˜ ë“¤ë„ ì•„ëž˜ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ë¥¼ ìž‘ì„±ì„ í•˜ì—¬ì„œ ê°œë°œì„ ì§„í–‰ í•˜ì˜€ìŠµë‹ˆë‹¤.

```typescript
it("test getChnageFiles()", async () => {
  const paginateMock = jest.spyOn(gh, "paginate")
  const reuslt = [{ filename: "filelist1" }, { filename: "filelist2" }]
  paginateMock.mockResolvedValue(reuslt)

  expect(await getChnageFiles(gh, 42)).toStrictEqual(
    reuslt.map((f) => f.filename)
  )
})
```

ë˜í•œ ì‹¤ì œ ê°œë°œì„ ì§„í–‰í•˜ëŠ” ì¤‘ê°„ ì‹¤ ë™ìž‘ì„ í™•ì¸ í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” test repoì— ì˜¬ë ¤ì„œ ì‹¤ì œë¡œ ë™ìž‘ì„ í…ŒìŠ¤íŠ¸ í•´ë³´ë©´ì„œ ì¼ë‹¨ ì´ˆê¸° ì•„ì´ë””ì–´ ë‹¨ê³„ë¥¼ ì „ë¶€ êµ¬í˜„ì„ í•˜ì—¬ì„œ ì™„ì„±ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

## ë¦¬ë·°ì–´ ë§¤ì¹­ workflow ë§Œë“¤ê¸°!

ì´ì œ PR ê²€ì¦ì— ëŒ€í•œ **Action**ì€ ì™„ì„±ì„ í•˜ì˜€ìœ¼ë‹ˆ ì´ì œ ë¼ë²¨ì„ ê°€ì§€ê³  Reviwerë¥¼ ë°°ì •í•˜ëŠ” workflowë¥¼ ì •ì˜ë¥¼ í•˜ì˜€ëŠ”ë° ì´ ê²½ìš°ì—ëŠ” ë³„ë„ì˜ App ìœ¼ë¡œ ë¶„ë¦¬í•˜ì§€ ì•Šê³  `actions/github-script@v4` ë¥¼ ì´ìš©í•˜ì—¬ `inline-script` í˜•íƒœë¡œ ê°„ë‹¨í•˜ê²Œ ìž‘ì„±ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ˆê¸°ì— ë‚˜ì˜¨ ë²„ì „ì€ ì•„ëž˜ì™€ ê°™ì´ ì™„ì„±ì„ í•˜ì—¬ **8ì›” 16ì¼**ì— ì²« ë„ìž…ì„ í•˜ì˜€ìŠµë‹ˆë‹¤!

```yaml
name: ë¦¬ë·°ì–´ ë§¤ì¹­

on:
  workflow_dispatch:
    inputs:
      subject:
        description: ìžë™ìœ¼ë¡œ ë§¤ì¹­ ì‹œí‚¬ íƒ€ê²Ÿ Subject
        required: true
      currect-label:
        description: ì •ìƒì ì¸ ì œì¶œ í™•ì¸ìš© ë¼ë²¨
        required: true
        default: "âœ… ì •ìƒì ì¸ ì œì¶œ"
      reviewer:
        description: ë¦¬ë·°ì–´ë¡œ ì§€ì •ë  íŒ€ëª…
        required: true
        default: "beta-pisciner"

jobs:
  matching-reviwers:
    name: "í•´ë‹¹ ì„œë¸Œì íŠ¸ Reviewer ë§¤ì¹­"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v4
        with:
          github-token: ${{ secrets.SECRET_PAT }}
          script: |
            const prlistConfig = github.pulls.list.endpoint.merge({
              owner: context.repo.owner,
              repo: context.repo.repo,
            });
            const prList = await github.paginate(prlistConfig);
            for (const pr of prList) {
              if (
                pr.state === "open" &&
                !!pr.labels.find(
                  (label) => label.name === "${{ github.event.inputs.subject }}"
                ) &&
                !!pr.labels.find(
                  (label) => label.name === "${{ github.event.inputs.currect-label }}"
                )
              ) {
                await github.pulls.requestReviewers({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  pull_number: pr.number,
                  team_reviewers: ["${{ github.event.inputs.reviewer }}"],
                });
                await github.issues.createComment({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: pr.number,
                body : [
                        `- ðŸŽ‰ í‰ê°€ ë§¤ì¹­ì´ ë˜ì…¨ìŠµë‹ˆë‹¤! ë¦¬ë·°ì–´ë¥¼ í™•ì¸í›„ ì•„ëž˜ì˜ ì£¼ì˜ ì‚¬í•­ì„ í™•ì¸í•˜ì—¬ ì§„í–‰ í•´ì£¼ì„¸ìš”!`,
                        `- âš ï¸ í‰ê°€ì‹œ ì£¼ì˜ ì‚¬í•­`,
                        `  - ë³¸ê³¼ì •ê³¼ ë™ì¼ í•˜ê²Œ ìœ„ì—ì„œ í‹€ë¦° ê²½ìš° ê·¸ ì¦‰ì‹œ í‰ê°€ì ìˆ˜ ë¶€ì—¬ëŠ” ë©ˆì¶°ì•¼ í•©ë‹ˆë‹¤.`,
                        `  - í‰ê°€ë¥¼ ì§„í–‰ í• ë•Œ PRì˜ CodeReview ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ \`approve\`ë¡œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.`,
                        `  - \`comment\` ë¡œ ìž‘ì„±í•˜ì—¬ ë‚¨ê²¨ì£¼ì‹œë©´ ìŠ¤íƒ­ë¶„ë“¤ì´ í™•ì¸í•˜ëŠ”ë° ì–´ë ¤ì›€ì„ ê²©ìŠµë‹ˆë‹¤ ã… ã… `,
                        `  - PR ë¦¬ë·°ì— êµ¬ê¸€ í¼ ì œì¶œ í›„ ë‚˜ì˜¤ëŠ” ì ìˆ˜ ê²°ê³¼ë¥¼ ê¼­ ê°™ì´ ì œì¶œ í•˜ì—¬ì£¼ì„¸ìš”!`,
                      ].join("\n"),
                });
              }
            }
```

ì¤‘ê°„ì— **reviewerë¥¼ teamìœ¼ë¡œ ë°°ì •** í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì œê³µë˜ëŠ” **repoì˜ token**ìœ¼ë¡œëŠ” ê¶Œí•œì´ ë¶€ì¡±í•˜ì—¬ ìž‘ë™í•˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ìžˆì–´ì„œ `PAT` ë¥¼ ë°œê¸‰ ë°›ì•„ ì ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

## ì²« ë„ìž… ì´í›„ ë°œìƒí•œ ì´ìŠˆ í•´ê²° í•˜ê¸°!

![image-20210820153916499](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/image-20210820153916499-9444711.png)

> Piscine ì ìš© ê³µì§€!

ì¼ë‹¨ ì ìš©ì´í›„ ë§Œë“  **Actionì˜ tag**ì„ ì •ì˜ í•˜ì—¬ ì‚¬ìš©í•˜ì˜€ëŠ”ë° ë°°í¬ë¥¼ í•  ë•Œ **pre-release** ë¡œ ì •ì˜ë¥¼ í•˜ì§€ ì•Šì•˜ë”ë‹ˆ ë²„ì „ê´€ë ¨í•´ì„œ ì°¾ì§€ ëª»í•˜ëŠ” ë¶€ë¶„ì´ ìžˆì–´ì„œ `42js/pr-checker@master` ë¡œ ì •ì˜ í•˜ì—¬ í•´ê²°ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

ë˜í•œ ì‹¤ ì ìš© ì´í›„ PRì´ ì˜¬ë¼ì˜¤ë©´ì„œ ì•„ëž˜ì™€ ê°™ì´ ì •ìƒì ì´ì§€ ì•ŠëŠ” PRë¡œ íŒì •ë˜ëŠ” ì´ìŠˆê°€ ìžˆì—ˆëŠ”ë° ì•Œê³  ë³´ë‹ˆ ì„¤ì •ì„ í•  ë•Œ `glob` í˜•íƒœë¥¼ ìž˜ëª» ìž‘ì„± í•˜ì—¬ ìƒê¸´ ë¬¸ì œì—¬ì„œ ì„¤ì •ì„ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

![image-20210820153839738](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/image-20210820153839738-9444716.png)

ê·¸ ê²°ê³¼ ì•„ëž˜ì™€ ê°™ì´ **PR**ì— ëŒ€í•´ ìž˜ ê²€ì‚¬ í›„ ë¼ë²¨ë§ì„ ì ìš© í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìžˆì—ˆìŠµë‹ˆë‹¤!

![image-20210820154219387](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/image-20210820154219387-9444720.png)

ê·¸ë¦¬ê³  **ë¦¬ë·°ì–´ ë§¤ì¹­** í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œë„ ì•„ëž˜ì™€ ê°™ì´ ì •ìƒì ìœ¼ë¡œ ìž˜ ë™ìž‘ í•œ ê²ƒì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤!

![image-20210820154534724](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/image-20210820154534724-9444725.png)

## ê°œì„  í•˜ê¸°!

`github-action` ë¥¼ ì²« ì ìš©ì´í›„ ì—¬ëŸ¬ê°€ì§€ ë¶ˆíŽ¸í•œ ë¶€ë¶„ê³¼ í•¨ê»˜ ê°œì„  í•´ì•¼ í•˜ëŠ” í•­ëª© ë“¤ì´ ë³´ì˜€ëŠ”ë° ê·¸ ë¶€ë¶„ì€ ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤.

`8ì›” 18ì¼` ê¸°ì¤€ PR ì œì¶œ ì´í›„ `Commit` ì€ **0ì  ì²˜ë¦¬ í•­ëª©ìœ¼ë¡œ ì •ì˜**ê°€ ë˜ì–´ ìžˆì–´ì„œ PRì— ë‹¤ë¥¸ ì„œë¸Œì íŠ¸ì— ëŒ€í•œ íŒŒì¼ì´ ì„žì—¬ ìžˆëŠ” ê²½ìš° actionì—ì„œ ë¹„ì •ìƒ ì œì¶œì„ ë°›ì•„ë„ ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥ í•˜ë‹¤ëŠ” ë¶€ë¶„ì´ ì²«ë²ˆì§¸ ë¬¸ì œ ì˜€ìŠµë‹ˆë‹¤.

ì¼ë‹¨ í•´ë‹¹ ì‚¬í•­ì— ëŒ€í•´ì„œ ë‚´ë¶€ì ìœ¼ë¡œ ë…¼ì˜ í›„ ì¼ë‹¨ í•´ë‹¹ ë‚ ì§œì—

ê¸°ì¡´ ê·œì¹™ì— ë‹¤ë¥¸ ì„œë¸Œì íŠ¸ì— ëŒ€í•œ íŒŒì¼ì´ í¬í•¨ë˜ì–´ ìžˆìœ¼ë©´ ì•ˆëœë‹¤ëŠ” ê·œì¹™ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œì´ì§€ë§Œ `GithubAction` ì—ì„œì˜ ì›í• í•œ ìž‘ë™ì„ ìœ„í•´ì„œëŠ” íŒŒì¼ ì œì¶œì— ëŒ€í•œ ì œì•½ì„ ê±¸ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— **ì œì¶œ ë°©ë²•ì— ëŒ€í•´** ì•„ëž˜ì™€ ê°™ì´ **íŒ€íšŒì˜ë¥¼** ì§„í–‰ í•˜ì˜€ìŠµë‹ˆë‹¤.

![ì œì¶œ ë°©ë²•ì— ëŒ€í•œ ë…¼ì˜](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/ì œì¶œ_ë°©ë²•ì—_ëŒ€í•œ_ë…¼ì˜.png)

ìµœì¢…ì ìœ¼ë¡œ ìœ„ì™€ ê°™ì´ ì œì¶œ ë°©ë²•ì— ëŒ€í•´ ìƒˆë¡­ê²Œ ìž¬ ì •ì˜ í›„ í•´ë‹¹ ë™ìž‘ëŒ€ë¡œ ìž‘ì—… í•  ìˆ˜ ìžˆë„ë¡ ê¸°ì¡´ ë¹„ì •ìƒ ì œì¶œì— ëŒ€í•œ `Close` í–‰ìœ„ë¥¼ ì œê±° í•¨ê³¼ `Action Trigger` ì— `PR synchronize` ë¥¼ ì¶”ê°€ í•¨ìœ¼ë¡œ ë™ê¸°í™” ì´ë²¤íŠ¸ ë°œìƒì‹œ ìž¬ ê²€ì‚¬ë¥¼ ë„ì™€ì¤„ ìˆ˜ ìžˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  `ë¦¬ë·°ì–´ ë§¤ì¹­ Action` ë¥¼ ë™ìž‘ ì‹œ í•´ë‹¹ ì‹œì ì„ ê¸°ì¤€ìœ¼ë¡œ `ë¹„ ì •ìƒ ì œì¶œ` ì— ëŒ€í•œ ë¼ë²¨ì´ ì ìš©ëœ ê²½ìš° ì•ˆë‚´ ë©”ì„¸ì§€ì™€ í•¨ê»˜ Close í•  ìˆ˜ ìžˆë„ë¡ ìˆ˜ì • í•˜ì—¿ìŠµë‹ˆë‹¤.

ìµœì¢…ì ìœ¼ë¡œ ë³€ê²½ ì‚¬í•­ì„ ì ìš© í›„ ê³µì§€ë¥¼ í•˜ì—¬ ê°œì„ ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

![image-20210820184531995](image/Github_actionë¥¼_ì´ìš©í•œ_ì»¤ë®¤ë‹ˆí‹°_í–‰ì‚¬_ê´€ë¦¬ìš´ì˜_í•˜ê¸°/image-20210820184531995.png)

## ë ë§ˆì¹˜ë©´ì„œ

í˜„ìž¬ **8ì›” 20ì¼** ê¸°ì¤€ **Github Action**ì„ í†µí•´ ìžë™í™”ë¥¼ ì ìš©í•´ë³´ë‹ˆ ê´€ë¦¬ ìš´ì˜ì„ í•˜ëŠ”ë° ì†Œëª¨ë˜ëŠ” ë¹„ìš©ì´ ì¤„ì–´ë“¤ê³  ìˆ˜ë™ìœ¼ë¡œ ì§„í–‰í•˜ë©´ì„œ ë°œìƒí•˜ëŠ” ì‹¤ìˆ˜ ë“¤ì´ ì—†ì–´ì§€ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ì»¤ë®¤ë‹ˆí‹° í™œë™ì´ë‚˜ ê°œë°œì„ ì§„í–‰ í•  ë•Œ **Github Action** ì„ ì ê·¹ì ìœ¼ë¡œ ì ìš©ì„ í•˜ì—¬ ì§„í–‰ì„ í•  ê²ƒ ìž…ë‹ˆë‹¤.

ë˜í•œ í˜„ìž¬ ì•„ì§ **8ì›” 31ì¼** ê¹Œì§€ **JS piscine ë² íƒ€**ê°€ ì§„í–‰ ë˜ê¸° ë•Œë¬¸ì— **ì¶”ê°€ì ìœ¼ë¡œ ìžë™í™”í•  ìˆ˜ ìžˆëŠ” ë¶€ë¶„ì— ëŒ€í•´ ì ìš© ë° ê°œì„ **í•˜ì—¬ ì§„í–‰í•  ê²ƒ ìž…ë‹ˆë‹¤!

---

> ### @42js/pr-checker
>
> - **Github: https://github.com/42js/pr-checker**
